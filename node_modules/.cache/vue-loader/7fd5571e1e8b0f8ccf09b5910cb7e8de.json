{"remainingRequest":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/src/views/lost-found/LostFound.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/src/views/lost-found/LostFound.vue","mtime":1712673873955},{"path":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/node_modules/cache-loader/dist/cjs.js","mtime":1712590523146},{"path":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/node_modules/babel-loader/lib/index.js","mtime":1712590523266},{"path":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/node_modules/cache-loader/dist/cjs.js","mtime":1712590523146},{"path":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/node_modules/vue-loader/lib/index.js","mtime":1712590523434}],"contextDependencies":[],"result":["\nimport ImageUploader from '@/components/common/ImageUploader'\n\nexport default {\n  name: 'LostFound',\n  components: {\n    ImageUploader\n  },\n  data() {\n    return {\n      menu: {\n        active: '查看所有',\n        items: ['查看所有', '失物招领', '寻物启事'],\n      },\n      param: {\n        // query 参数\n        lostFoundCategory: null,\n        general: null,\n        // page & order 参数\n        desc: 'create_time',\n        current: 1\n      },\n      lostFoundPage: {\n        'records': [\n          {\n            'id': 1,\n            'userId': 1,\n            'resourceId': 16,\n            'lostFoundCategory': '寻物启事',\n            'title': '四食堂丢失一个钱包',\n            'description': '如图，钱包是黑色的，里面有少量现金和一张工行的卡',\n            'itemName': '钱包',\n            'time': '2024-05-17 12:10:01',\n            'address': '四食堂',\n            'createTime': '2024-05-17 15:39:45',\n            'images': ['https://img12.360buyimg.com/n7/jfs/t22831/61/2367409622/289066/5d9c3f/5b7d10feNe776b305.jpg'],\n            'user': {\n              'id': 1,\n              'username': 'admin',\n              'nickname': '管理员',\n              'avatar': 'http://img.angus-liu.cn/avatar/avatar07.png',\n              'sign': '一句话介绍自己'\n            },\n            'resource': {\n              'id': 16,\n              'zanCount': 0,\n              'pvCount': 0,\n              'commentCount': 0\n            }\n          }\n        ],\n        'total': 5,\n        'size': 1,\n        'current': 1,\n        'searchCount': true,\n        'pages': 5\n      },\n      lostFoundAddModal: {\n        show: false,\n        title: '发布寻物启事',\n        placeholder: {\n          time: '请选择丢失时间',\n          address: '请填写丢失地点'\n        },\n        form: {\n          lostFoundCategory: '寻物启事',\n          title: '',\n          itemName: '',\n          time: null,\n          address: '',\n          description: '',\n          images: null,\n        }\n      },\n      commentList: [{\n        id: -1,\n        content: '测试评论',\n        createTime: '2024-05-21 20:15:39',\n        postUser: {\n          id: -1,\n          username: 'admin',\n          nickname: '管理员',\n          avatar: 'http://img.angus-liu.cn/avatar/avatar07.png'\n        },\n        children: [\n          {\n            id: -2,\n            content: '测试回复',\n            createTime: '2024-05-21 20:15:46',\n            postUser: {\n              id: 1,\n              username: 'admin',\n              nickname: '管理员',\n              avatar: 'http://img.angus-liu.cn/avatar/avatar07.png'\n            },\n            replyUser: {\n              id: 1,\n              username: 'admin',\n              nickname: '管理员',\n              avatar: 'http://img.angus-liu.cn/avatar/avatar07.png'\n            }\n          }\n        ]\n      }],\n      commentAddModal: {\n        show: false,\n        form: {\n          parentId: null,\n          resourceId: null,\n          replyUserId: null,\n          value: '',\n          content: ''\n        }\n      },\n      currentResource: {}\n    }\n  },\n  methods: {\n    // 切换菜单\n    select(item) {\n      this.menu.active = item;\n      switch (item) {\n        case '查看所有':\n          this.param.lostFoundCategory = null;\n          break;\n        case '失物招领':\n          this.param.lostFoundCategory = '失物招领';\n          break;\n        case '寻物启事':\n          this.param.lostFoundCategory = '寻物启事';\n          break;\n      }\n      this.param.current = 1;\n      this.getLostFoundPage(this.param);\n    },\n    // 获取失物寻物分页\n    getLostFoundPage(param) {\n      this.$axios.get('/api/lost-found/page', param)\n        .then(res => {\n          let result = res.data;\n          this.lostFoundPage = result.data;\n          this.lostFoundPage.records.forEach(lostFound => {\n            if (lostFound.images && lostFound.images.length > 0) {\n              lostFound.images = JSON.parse(lostFound.images);\n            }\n          })\n        })\n    },\n    // 配置失物寻物添加模态框\n    showLostFoundModal(type) {\n      if (type === '寻物启事') {\n        this.lostFoundAddModal = {\n          show: true,\n          title: '发布寻物启事',\n          placeholder: {\n            time: '请选择丢失时间',\n            address: '请填写丢失地点'\n          },\n          form: {\n            lostFoundCategory: '寻物启事',\n            title: '',\n            itemName: '',\n            time: null,\n            address: '',\n            description: '',\n            images: null,\n          }\n        }\n      } else {\n        this.lostFoundAddModal = {\n          show: true,\n          title: '发布失物招领',\n          placeholder: {\n            time: '请选择拾取时间',\n            address: '请填写拾取地点'\n          },\n          form: {\n            lostFoundCategory: '失物招领',\n            title: '',\n            itemName: '',\n            time: null,\n            address: '',\n            description: '',\n            images: null,\n          }\n        }\n      }\n    },\n    // 添加失物寻物\n    addLostFound() {\n      let lostFoundAddForm = this.lostFoundAddModal.form;\n      lostFoundAddForm.images = JSON.stringify(lostFoundAddForm.images);\n      this.$axios.post('/api/lost-found', lostFoundAddForm)\n        .then(res => {\n          let result = res.data;\n          if (result.success) {\n            this.$Notice.success({ title: 'Bingo', desc: '发布成功' });\n            this.lostFoundAddModal.show = false;\n            this.$refs.imageUploader.clearImages();\n            this.getLostFoundPage(this.param);\n          }\n        });\n    },\n    // 加载更多\n    loadMore() {\n      this.param.current++;\n      this.$axios.get('/api/lost-found/page', this.param)\n        .then(res => {\n          let result = res.data;\n          let moreLostFoundPage = result.data;\n          moreLostFoundPage.records.forEach(lostFound => {\n            if (lostFound.images && lostFound.images.length > 0) {\n              lostFound.images = JSON.parse(lostFound.images);\n            }\n          });\n          this.lostFoundPage.records.push(...moreLostFoundPage.records);\n        });\n    },\n    // 点赞\n    addZan(resource) {\n      this.$axios.post('/api/zan', { resourceId: resource.id })\n        .then(res => resource.zanCount++);\n    },\n    // 获取评论\n    getCommentList(resource) {\n      this.currentResource = resource;\n      this.$axios.get(`/api/comment/${resource.id}`)\n        .then(res => {\n          let result = res.data;\n          this.commentList = result.data;\n          // 展示评论\n          this.commentAddModal.show = true;\n        });\n    },\n    // 初始化评论\n    initComment() {\n      this.commentAddModal.form = {\n        resourceId: null,\n        parentId: null,\n        replyUserId: null,\n        value: '',\n        content: ''\n      }\n    },\n    // 添加评论\n    addComment() {\n      // 设置资源 ID\n      this.commentAddModal.form.resourceId = this.currentResource.id;\n      // 判断是评论还是回复\n      if (this.commentAddModal.form.value.startsWith('@')\n        && this.commentAddModal.form.replyUserId !== null) {\n        // 回复时去掉评论内容中的回复用户名\n        let index = this.commentAddModal.form.value.indexOf(' ');\n        this.commentAddModal.form.content = this.commentAddModal.form.value.substr(index + 1);\n      } else {\n        this.commentAddModal.form.parentId = null;\n        this.commentAddModal.form.replyUserId = null;\n        this.commentAddModal.form.content = this.commentAddModal.form.value;\n      }\n      this.$axios.post('/api/comment', this.commentAddModal.form)\n        .then(res => {\n          this.initComment();\n          this.currentResource.commentCount++;\n          this.getCommentList(this.currentResource);\n        });\n    },\n    // 回复评论\n    replyComment(parentId, replyUser) {\n      this.commentAddModal.form.parentId = parentId;\n      this.commentAddModal.form.replyUserId = replyUser.id;\n      this.commentAddModal.form.value = `@${replyUser.nickname} `;\n      this.$refs.commentInput.focus();\n    }\n  },\n  mounted() {\n    this.getLostFoundPage(this.param);\n  }\n}\n",{"version":3,"sources":["LostFound.vue"],"names":[],"mappings":";AAsKA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"LostFound.vue","sourceRoot":"src/views/lost-found","sourcesContent":["<template>\n  <div class=\"container\">\n    <Row>\n      <iCol class=\"column\" span=\"16\">\n        <!-- 失物寻物菜单 -->\n        <sui-menu>\n          <sui-menu-item link v-for=\"item in menu.items\" :key=\"item\" :content=\"item\"\n                         :active=\"item === menu.active\" @click=\"select(item)\"/>\n          <sui-menu-item position=\"right\">\n            <sui-input transparent icon=\"search\" placeholder=\"搜索\"\n                       v-model=\"param.general\" @keydown.enter=\"getLostFoundPage(param)\"/>\n          </sui-menu-item>\n        </sui-menu>\n        <!-- 失物寻物菜单 END -->\n        <!-- 失物寻物列表 -->\n        <sui-card class=\"fluid lost-found-card\" v-for=\"lostFound in lostFoundPage.records\" :key=\"lostFound.id\">\n          <sui-card-content>\n            <sui-feed>\n              <sui-feed-event>\n                <sui-feed-content>\n                  <sui-feed-summary>\n                    <sui-label class=\"lost-found-category\" basic\n                               :color=\"lostFound.lostFoundCategory === '寻物启事'? 'red':'green'\">\n                      {{lostFound.lostFoundCategory}}\n                    </sui-label>\n                    <router-link class=\"lost-found-title\" :to=\"'/lost-found/' + lostFound.id\">{{lostFound.title}}\n                    </router-link>\n                    <sui-feed-date>\n                      <Time :time=\"lostFound.createTime\"/>\n                    </sui-feed-date>\n                  </sui-feed-summary>\n                  <sui-feed-extra class=\"lost-found-extra\" text>\n                    <Row>\n                      <iCol span=\"7\">👜 {{lostFound.itemName}}</iCol>\n                      <iCol span=\"9\">🕓 {{lostFound.time}}</iCol>\n                      <iCol span=\"5\" offset=\"3\">📍 {{lostFound.address}}</iCol>\n                    </Row>\n                    <div class=\"lost-found-description\">{{lostFound.description}}</div>\n                  </sui-feed-extra>\n                  <sui-feed-extra class=\"lost-found-images\" images\n                                  v-if=\"lostFound.images && lostFound.images.length > 0\">\n                    <img v-for=\"img in lostFound.images\" :src=\"img\">\n                  </sui-feed-extra>\n                  <sui-feed-meta>\n                    <router-link :to=\"'/user/' + lostFound.user.id\">\n                      <sui-image :src=\"lostFound.user.avatar\" size=\"medium\" avatar/>\n                      <span style=\"position: relative; top: 2px\">{{lostFound.user.nickname}}</span>\n                    </router-link>\n                    <sui-feed-like @click=\"addZan(lostFound.resource)\">\n                      👍 {{lostFound.resource.zanCount}}\n                    </sui-feed-like>\n                    <sui-feed-like @click=\"getCommentList(lostFound.resource)\">\n                      💬 {{lostFound.resource.commentCount}}\n                    </sui-feed-like>\n                  </sui-feed-meta>\n                </sui-feed-content>\n              </sui-feed-event>\n            </sui-feed>\n          </sui-card-content>\n        </sui-card>\n        <!-- 失物寻物列表 END -->\n        <!-- 加载更多 -->\n        <sui-button class=\"fluid\" basic content=\"加载更多\" @click=\"loadMore\"\n                    :disabled=\"param.current >= lostFoundPage.pages\"/>\n        <!-- 加载更多 END -->\n      </iCol>\n      <iCol class=\"column\" span=\"8\">\n        <!-- 寻物启事提示 -->\n        <sui-card class=\"fluid\">\n          <sui-message attached=\"top\" icon=\"eye\" negative>\n            <sui-message-header>寻物启事小贴士</sui-message-header>\n            <p>什么，有东西丢啦？不要怕，快来发布一条寻物启事吧，很快就会有好心人联系你啦。对啦，一定要核实信息，准确后再发布哦 😃</p>\n          </sui-message>\n          <sui-button attached=\"bottom\" icon=\"add\" content=\"发布寻物启事\" @click=\"showLostFoundModal('寻物启事')\"/>\n        </sui-card>\n        <!-- 寻物启事提示 END -->\n        <!-- 失物招领提示 -->\n        <sui-card class=\"fluid\">\n          <sui-message attached=\"top\" icon=\"bullhorn\" positive>\n            <sui-message-content>\n              <sui-message-header>失物招领小贴士</sui-message-header>\n              <p>捡到哪位同学不小信掉落的物品啦？快发布一条失物招领吧，失主一定会非常非常感激你呢 😘</p>\n            </sui-message-content>\n          </sui-message>\n          <sui-button attached=\"bottom\" icon=\"add\" content=\"发布失物招领\" @click=\"showLostFoundModal('失物招领')\"/>\n        </sui-card>\n        <!-- 失物招领提示 END -->\n      </iCol>\n    </Row>\n    <!-- 失物寻物添加模态框 -->\n    <Modal v-model=\"lostFoundAddModal.show\" :title=\"lostFoundAddModal.title\" width=\"600\" scrollable>\n      <Form :model=\"lostFoundAddModal.form\" :label-width=\"50\">\n        <FormItem label=\"标题\" required>\n          <Input v-model=\"lostFoundAddModal.form.title\" size=\"large\" placeholder=\"清晰的标题能让更多人注意到\"/>\n        </FormItem>\n        <FormItem label=\"物品\" required>\n          <Input v-model=\"lostFoundAddModal.form.itemName\" size=\"large\" placeholder=\"请填写物品名\"/>\n        </FormItem>\n        <FormItem label=\"时间\" required>\n          <DatePicker :value=\"lostFoundAddModal.form.time\" @on-change=\"time => lostFoundAddModal.form.time = time\"\n                      type=\"datetime\" size=\"large\" :placeholder=\"lostFoundAddModal.placeholder.time\"\n                      style=\"width: 100%\"/>\n        </FormItem>\n        <FormItem label=\"地点\" required>\n          <Input v-model=\"lostFoundAddModal.form.address\" size=\"large\"\n                 :placeholder=\"lostFoundAddModal.placeholder.address\"/>\n        </FormItem>\n        <FormItem label=\"描述\" required>\n          <Input v-model=\"lostFoundAddModal.form.description\" type=\"textarea\" size=\"large\"\n                 :autosize=\"{minRows: 5,maxRows: 10}\" placeholder=\"输入物品描述，有助于他人获取信息\"/>\n        </FormItem>\n        <FormItem label=\"图片\" style=\"margin-bottom: 0\">\n          <ImageUploader ref=\"imageUploader\" @images-change=\"images => lostFoundAddModal.form.images = images\"/>\n        </FormItem>\n      </Form>\n      <template #footer>\n        <Button type=\"text\" @click=\"lostFoundAddModal.show = false\">取消</Button>\n        <Button @click=\"addLostFound\">确定发布</Button>\n      </template>\n    </Modal>\n    <!-- 失物寻物添加模态框 END -->\n    <!-- 评论模态框 -->\n    <Modal v-model=\"commentAddModal.show\" title=\"发表评论\" width=\"600\" footer-hide>\n      <Input ref=\"commentInput\" v-model=\"commentAddModal.form.value\" type=\"textarea\" :rows=\"3\" placeholder=\"添加评论\"\n             @on-enter=\"addComment\"/>\n      <sui-comment-group class=\"comment-group\">\n        <sui-comment v-for=\"comment in commentList\" :key=\"comment.id\">\n          <sui-comment-avatar :src=\"comment.postUser.avatar\"/>\n          <sui-comment-content>\n            <a is=\"sui-comment-author\">{{comment.postUser.nickname}}</a>\n            <sui-comment-metadata>\n              <Time :time=\"comment.createTime\"/>\n            </sui-comment-metadata>\n            <sui-comment-text>{{comment.content}}</sui-comment-text>\n            <sui-comment-actions>\n              <sui-comment-action @click=\"replyComment(comment.id, comment.postUser)\">回复</sui-comment-action>\n            </sui-comment-actions>\n          </sui-comment-content>\n          <!-- 子评论 -->\n          <sui-comment-group v-if=\"comment.children.length > 0\">\n            <sui-comment v-for=\"child in comment.children\" :key=\"child.id\">\n              <sui-comment-avatar :src=\"child.postUser.avatar\"/>\n              <sui-comment-content>\n                <a is=\"sui-comment-author\">{{child.postUser.nickname}}</a>\n                <sui-comment-metadata>\n                  <Time :time=\"child.createTime\"/>\n                </sui-comment-metadata>\n                <sui-comment-text>\n                  <a :href=\"child.replyUser.id\">@{{child.replyUser.nickname}}</a>\n                  {{child.content}}\n                </sui-comment-text>\n                <sui-comment-actions>\n                  <sui-comment-action @click=\"replyComment(comment.id, child.postUser)\">回复</sui-comment-action>\n                </sui-comment-actions>\n              </sui-comment-content>\n            </sui-comment>\n          </sui-comment-group>\n          <!-- 子评论 END -->\n        </sui-comment>\n      </sui-comment-group>\n    </Modal>\n    <!-- 评论模态框 END -->\n  </div>\n</template>\n\n<script>\nimport ImageUploader from '@/components/common/ImageUploader'\n\nexport default {\n  name: 'LostFound',\n  components: {\n    ImageUploader\n  },\n  data() {\n    return {\n      menu: {\n        active: '查看所有',\n        items: ['查看所有', '失物招领', '寻物启事'],\n      },\n      param: {\n        // query 参数\n        lostFoundCategory: null,\n        general: null,\n        // page & order 参数\n        desc: 'create_time',\n        current: 1\n      },\n      lostFoundPage: {\n        'records': [\n          {\n            'id': 1,\n            'userId': 1,\n            'resourceId': 16,\n            'lostFoundCategory': '寻物启事',\n            'title': '四食堂丢失一个钱包',\n            'description': '如图，钱包是黑色的，里面有少量现金和一张工行的卡',\n            'itemName': '钱包',\n            'time': '2024-05-17 12:10:01',\n            'address': '四食堂',\n            'createTime': '2024-05-17 15:39:45',\n            'images': ['https://img12.360buyimg.com/n7/jfs/t22831/61/2367409622/289066/5d9c3f/5b7d10feNe776b305.jpg'],\n            'user': {\n              'id': 1,\n              'username': 'admin',\n              'nickname': '管理员',\n              'avatar': 'http://img.angus-liu.cn/avatar/avatar07.png',\n              'sign': '一句话介绍自己'\n            },\n            'resource': {\n              'id': 16,\n              'zanCount': 0,\n              'pvCount': 0,\n              'commentCount': 0\n            }\n          }\n        ],\n        'total': 5,\n        'size': 1,\n        'current': 1,\n        'searchCount': true,\n        'pages': 5\n      },\n      lostFoundAddModal: {\n        show: false,\n        title: '发布寻物启事',\n        placeholder: {\n          time: '请选择丢失时间',\n          address: '请填写丢失地点'\n        },\n        form: {\n          lostFoundCategory: '寻物启事',\n          title: '',\n          itemName: '',\n          time: null,\n          address: '',\n          description: '',\n          images: null,\n        }\n      },\n      commentList: [{\n        id: -1,\n        content: '测试评论',\n        createTime: '2024-05-21 20:15:39',\n        postUser: {\n          id: -1,\n          username: 'admin',\n          nickname: '管理员',\n          avatar: 'http://img.angus-liu.cn/avatar/avatar07.png'\n        },\n        children: [\n          {\n            id: -2,\n            content: '测试回复',\n            createTime: '2024-05-21 20:15:46',\n            postUser: {\n              id: 1,\n              username: 'admin',\n              nickname: '管理员',\n              avatar: 'http://img.angus-liu.cn/avatar/avatar07.png'\n            },\n            replyUser: {\n              id: 1,\n              username: 'admin',\n              nickname: '管理员',\n              avatar: 'http://img.angus-liu.cn/avatar/avatar07.png'\n            }\n          }\n        ]\n      }],\n      commentAddModal: {\n        show: false,\n        form: {\n          parentId: null,\n          resourceId: null,\n          replyUserId: null,\n          value: '',\n          content: ''\n        }\n      },\n      currentResource: {}\n    }\n  },\n  methods: {\n    // 切换菜单\n    select(item) {\n      this.menu.active = item;\n      switch (item) {\n        case '查看所有':\n          this.param.lostFoundCategory = null;\n          break;\n        case '失物招领':\n          this.param.lostFoundCategory = '失物招领';\n          break;\n        case '寻物启事':\n          this.param.lostFoundCategory = '寻物启事';\n          break;\n      }\n      this.param.current = 1;\n      this.getLostFoundPage(this.param);\n    },\n    // 获取失物寻物分页\n    getLostFoundPage(param) {\n      this.$axios.get('/api/lost-found/page', param)\n        .then(res => {\n          let result = res.data;\n          this.lostFoundPage = result.data;\n          this.lostFoundPage.records.forEach(lostFound => {\n            if (lostFound.images && lostFound.images.length > 0) {\n              lostFound.images = JSON.parse(lostFound.images);\n            }\n          })\n        })\n    },\n    // 配置失物寻物添加模态框\n    showLostFoundModal(type) {\n      if (type === '寻物启事') {\n        this.lostFoundAddModal = {\n          show: true,\n          title: '发布寻物启事',\n          placeholder: {\n            time: '请选择丢失时间',\n            address: '请填写丢失地点'\n          },\n          form: {\n            lostFoundCategory: '寻物启事',\n            title: '',\n            itemName: '',\n            time: null,\n            address: '',\n            description: '',\n            images: null,\n          }\n        }\n      } else {\n        this.lostFoundAddModal = {\n          show: true,\n          title: '发布失物招领',\n          placeholder: {\n            time: '请选择拾取时间',\n            address: '请填写拾取地点'\n          },\n          form: {\n            lostFoundCategory: '失物招领',\n            title: '',\n            itemName: '',\n            time: null,\n            address: '',\n            description: '',\n            images: null,\n          }\n        }\n      }\n    },\n    // 添加失物寻物\n    addLostFound() {\n      let lostFoundAddForm = this.lostFoundAddModal.form;\n      lostFoundAddForm.images = JSON.stringify(lostFoundAddForm.images);\n      this.$axios.post('/api/lost-found', lostFoundAddForm)\n        .then(res => {\n          let result = res.data;\n          if (result.success) {\n            this.$Notice.success({ title: 'Bingo', desc: '发布成功' });\n            this.lostFoundAddModal.show = false;\n            this.$refs.imageUploader.clearImages();\n            this.getLostFoundPage(this.param);\n          }\n        });\n    },\n    // 加载更多\n    loadMore() {\n      this.param.current++;\n      this.$axios.get('/api/lost-found/page', this.param)\n        .then(res => {\n          let result = res.data;\n          let moreLostFoundPage = result.data;\n          moreLostFoundPage.records.forEach(lostFound => {\n            if (lostFound.images && lostFound.images.length > 0) {\n              lostFound.images = JSON.parse(lostFound.images);\n            }\n          });\n          this.lostFoundPage.records.push(...moreLostFoundPage.records);\n        });\n    },\n    // 点赞\n    addZan(resource) {\n      this.$axios.post('/api/zan', { resourceId: resource.id })\n        .then(res => resource.zanCount++);\n    },\n    // 获取评论\n    getCommentList(resource) {\n      this.currentResource = resource;\n      this.$axios.get(`/api/comment/${resource.id}`)\n        .then(res => {\n          let result = res.data;\n          this.commentList = result.data;\n          // 展示评论\n          this.commentAddModal.show = true;\n        });\n    },\n    // 初始化评论\n    initComment() {\n      this.commentAddModal.form = {\n        resourceId: null,\n        parentId: null,\n        replyUserId: null,\n        value: '',\n        content: ''\n      }\n    },\n    // 添加评论\n    addComment() {\n      // 设置资源 ID\n      this.commentAddModal.form.resourceId = this.currentResource.id;\n      // 判断是评论还是回复\n      if (this.commentAddModal.form.value.startsWith('@')\n        && this.commentAddModal.form.replyUserId !== null) {\n        // 回复时去掉评论内容中的回复用户名\n        let index = this.commentAddModal.form.value.indexOf(' ');\n        this.commentAddModal.form.content = this.commentAddModal.form.value.substr(index + 1);\n      } else {\n        this.commentAddModal.form.parentId = null;\n        this.commentAddModal.form.replyUserId = null;\n        this.commentAddModal.form.content = this.commentAddModal.form.value;\n      }\n      this.$axios.post('/api/comment', this.commentAddModal.form)\n        .then(res => {\n          this.initComment();\n          this.currentResource.commentCount++;\n          this.getCommentList(this.currentResource);\n        });\n    },\n    // 回复评论\n    replyComment(parentId, replyUser) {\n      this.commentAddModal.form.parentId = parentId;\n      this.commentAddModal.form.replyUserId = replyUser.id;\n      this.commentAddModal.form.value = `@${replyUser.nickname} `;\n      this.$refs.commentInput.focus();\n    }\n  },\n  mounted() {\n    this.getLostFoundPage(this.param);\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.container {\n  width: 1140px;\n  margin: 0 auto;\n  padding: 5px;\n\n  .column {\n    padding: 7px;\n  }\n\n  .lost-found-card {\n    .lost-found-category {\n      margin-right: 5px;\n    }\n\n    a.lost-found-title {\n      color: #455A64;\n    }\n\n    a.lost-found-title:hover {\n      color: #FF8364;\n    }\n\n    .lost-found-extra {\n      width: 100%;\n\n      .lost-found-description {\n        margin: 10px 0;\n        color: #444;\n      }\n    }\n  }\n}\n</style>\n"]}]}