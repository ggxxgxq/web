{"remainingRequest":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/src/views/lost-found/LostFound.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/src/views/lost-found/LostFound.vue","mtime":1712673873955},{"path":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/node_modules/cache-loader/dist/cjs.js","mtime":1712590523146},{"path":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/node_modules/babel-loader/lib/index.js","mtime":1712590523266},{"path":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/node_modules/cache-loader/dist/cjs.js","mtime":1712590523146},{"path":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/node_modules/vue-loader/lib/index.js","mtime":1712590523434}],"contextDependencies":[],"result":["\nimport ImageUploader from '@/components/common/ImageUploader'\n\nexport default {\n  name: 'LostFound',\n  components: {\n    ImageUploader\n  },\n  data() {\n    return {\n      menu: {\n        active: 'æŸ¥çœ‹æ‰€æœ‰',\n        items: ['æŸ¥çœ‹æ‰€æœ‰', 'å¤±ç‰©æ‹›é¢†', 'å¯»ç‰©å¯äº‹'],\n      },\n      param: {\n        // query å‚æ•°\n        lostFoundCategory: null,\n        general: null,\n        // page & order å‚æ•°\n        desc: 'create_time',\n        current: 1\n      },\n      lostFoundPage: {\n        'records': [\n          {\n            'id': 1,\n            'userId': 1,\n            'resourceId': 16,\n            'lostFoundCategory': 'å¯»ç‰©å¯äº‹',\n            'title': 'å››é£Ÿå ‚ä¸¢å¤±ä¸€ä¸ªé’±åŒ…',\n            'description': 'å¦‚å›¾ï¼Œé’±åŒ…æ˜¯é»‘è‰²çš„ï¼Œé‡Œé¢æœ‰å°‘é‡ç°é‡‘å’Œä¸€å¼ å·¥è¡Œçš„å¡',\n            'itemName': 'é’±åŒ…',\n            'time': '2024-05-17 12:10:01',\n            'address': 'å››é£Ÿå ‚',\n            'createTime': '2024-05-17 15:39:45',\n            'images': ['https://img12.360buyimg.com/n7/jfs/t22831/61/2367409622/289066/5d9c3f/5b7d10feNe776b305.jpg'],\n            'user': {\n              'id': 1,\n              'username': 'admin',\n              'nickname': 'ç®¡ç†å‘˜',\n              'avatar': 'http://img.angus-liu.cn/avatar/avatar07.png',\n              'sign': 'ä¸€å¥è¯ä»‹ç»è‡ªå·±'\n            },\n            'resource': {\n              'id': 16,\n              'zanCount': 0,\n              'pvCount': 0,\n              'commentCount': 0\n            }\n          }\n        ],\n        'total': 5,\n        'size': 1,\n        'current': 1,\n        'searchCount': true,\n        'pages': 5\n      },\n      lostFoundAddModal: {\n        show: false,\n        title: 'å‘å¸ƒå¯»ç‰©å¯äº‹',\n        placeholder: {\n          time: 'è¯·é€‰æ‹©ä¸¢å¤±æ—¶é—´',\n          address: 'è¯·å¡«å†™ä¸¢å¤±åœ°ç‚¹'\n        },\n        form: {\n          lostFoundCategory: 'å¯»ç‰©å¯äº‹',\n          title: '',\n          itemName: '',\n          time: null,\n          address: '',\n          description: '',\n          images: null,\n        }\n      },\n      commentList: [{\n        id: -1,\n        content: 'æµ‹è¯•è¯„è®º',\n        createTime: '2024-05-21 20:15:39',\n        postUser: {\n          id: -1,\n          username: 'admin',\n          nickname: 'ç®¡ç†å‘˜',\n          avatar: 'http://img.angus-liu.cn/avatar/avatar07.png'\n        },\n        children: [\n          {\n            id: -2,\n            content: 'æµ‹è¯•å›å¤',\n            createTime: '2024-05-21 20:15:46',\n            postUser: {\n              id: 1,\n              username: 'admin',\n              nickname: 'ç®¡ç†å‘˜',\n              avatar: 'http://img.angus-liu.cn/avatar/avatar07.png'\n            },\n            replyUser: {\n              id: 1,\n              username: 'admin',\n              nickname: 'ç®¡ç†å‘˜',\n              avatar: 'http://img.angus-liu.cn/avatar/avatar07.png'\n            }\n          }\n        ]\n      }],\n      commentAddModal: {\n        show: false,\n        form: {\n          parentId: null,\n          resourceId: null,\n          replyUserId: null,\n          value: '',\n          content: ''\n        }\n      },\n      currentResource: {}\n    }\n  },\n  methods: {\n    // åˆ‡æ¢èœå•\n    select(item) {\n      this.menu.active = item;\n      switch (item) {\n        case 'æŸ¥çœ‹æ‰€æœ‰':\n          this.param.lostFoundCategory = null;\n          break;\n        case 'å¤±ç‰©æ‹›é¢†':\n          this.param.lostFoundCategory = 'å¤±ç‰©æ‹›é¢†';\n          break;\n        case 'å¯»ç‰©å¯äº‹':\n          this.param.lostFoundCategory = 'å¯»ç‰©å¯äº‹';\n          break;\n      }\n      this.param.current = 1;\n      this.getLostFoundPage(this.param);\n    },\n    // è·å–å¤±ç‰©å¯»ç‰©åˆ†é¡µ\n    getLostFoundPage(param) {\n      this.$axios.get('/api/lost-found/page', param)\n        .then(res => {\n          let result = res.data;\n          this.lostFoundPage = result.data;\n          this.lostFoundPage.records.forEach(lostFound => {\n            if (lostFound.images && lostFound.images.length > 0) {\n              lostFound.images = JSON.parse(lostFound.images);\n            }\n          })\n        })\n    },\n    // é…ç½®å¤±ç‰©å¯»ç‰©æ·»åŠ æ¨¡æ€æ¡†\n    showLostFoundModal(type) {\n      if (type === 'å¯»ç‰©å¯äº‹') {\n        this.lostFoundAddModal = {\n          show: true,\n          title: 'å‘å¸ƒå¯»ç‰©å¯äº‹',\n          placeholder: {\n            time: 'è¯·é€‰æ‹©ä¸¢å¤±æ—¶é—´',\n            address: 'è¯·å¡«å†™ä¸¢å¤±åœ°ç‚¹'\n          },\n          form: {\n            lostFoundCategory: 'å¯»ç‰©å¯äº‹',\n            title: '',\n            itemName: '',\n            time: null,\n            address: '',\n            description: '',\n            images: null,\n          }\n        }\n      } else {\n        this.lostFoundAddModal = {\n          show: true,\n          title: 'å‘å¸ƒå¤±ç‰©æ‹›é¢†',\n          placeholder: {\n            time: 'è¯·é€‰æ‹©æ‹¾å–æ—¶é—´',\n            address: 'è¯·å¡«å†™æ‹¾å–åœ°ç‚¹'\n          },\n          form: {\n            lostFoundCategory: 'å¤±ç‰©æ‹›é¢†',\n            title: '',\n            itemName: '',\n            time: null,\n            address: '',\n            description: '',\n            images: null,\n          }\n        }\n      }\n    },\n    // æ·»åŠ å¤±ç‰©å¯»ç‰©\n    addLostFound() {\n      let lostFoundAddForm = this.lostFoundAddModal.form;\n      lostFoundAddForm.images = JSON.stringify(lostFoundAddForm.images);\n      this.$axios.post('/api/lost-found', lostFoundAddForm)\n        .then(res => {\n          let result = res.data;\n          if (result.success) {\n            this.$Notice.success({ title: 'Bingo', desc: 'å‘å¸ƒæˆåŠŸ' });\n            this.lostFoundAddModal.show = false;\n            this.$refs.imageUploader.clearImages();\n            this.getLostFoundPage(this.param);\n          }\n        });\n    },\n    // åŠ è½½æ›´å¤š\n    loadMore() {\n      this.param.current++;\n      this.$axios.get('/api/lost-found/page', this.param)\n        .then(res => {\n          let result = res.data;\n          let moreLostFoundPage = result.data;\n          moreLostFoundPage.records.forEach(lostFound => {\n            if (lostFound.images && lostFound.images.length > 0) {\n              lostFound.images = JSON.parse(lostFound.images);\n            }\n          });\n          this.lostFoundPage.records.push(...moreLostFoundPage.records);\n        });\n    },\n    // ç‚¹èµ\n    addZan(resource) {\n      this.$axios.post('/api/zan', { resourceId: resource.id })\n        .then(res => resource.zanCount++);\n    },\n    // è·å–è¯„è®º\n    getCommentList(resource) {\n      this.currentResource = resource;\n      this.$axios.get(`/api/comment/${resource.id}`)\n        .then(res => {\n          let result = res.data;\n          this.commentList = result.data;\n          // å±•ç¤ºè¯„è®º\n          this.commentAddModal.show = true;\n        });\n    },\n    // åˆå§‹åŒ–è¯„è®º\n    initComment() {\n      this.commentAddModal.form = {\n        resourceId: null,\n        parentId: null,\n        replyUserId: null,\n        value: '',\n        content: ''\n      }\n    },\n    // æ·»åŠ è¯„è®º\n    addComment() {\n      // è®¾ç½®èµ„æº ID\n      this.commentAddModal.form.resourceId = this.currentResource.id;\n      // åˆ¤æ–­æ˜¯è¯„è®ºè¿˜æ˜¯å›å¤\n      if (this.commentAddModal.form.value.startsWith('@')\n        && this.commentAddModal.form.replyUserId !== null) {\n        // å›å¤æ—¶å»æ‰è¯„è®ºå†…å®¹ä¸­çš„å›å¤ç”¨æˆ·å\n        let index = this.commentAddModal.form.value.indexOf(' ');\n        this.commentAddModal.form.content = this.commentAddModal.form.value.substr(index + 1);\n      } else {\n        this.commentAddModal.form.parentId = null;\n        this.commentAddModal.form.replyUserId = null;\n        this.commentAddModal.form.content = this.commentAddModal.form.value;\n      }\n      this.$axios.post('/api/comment', this.commentAddModal.form)\n        .then(res => {\n          this.initComment();\n          this.currentResource.commentCount++;\n          this.getCommentList(this.currentResource);\n        });\n    },\n    // å›å¤è¯„è®º\n    replyComment(parentId, replyUser) {\n      this.commentAddModal.form.parentId = parentId;\n      this.commentAddModal.form.replyUserId = replyUser.id;\n      this.commentAddModal.form.value = `@${replyUser.nickname} `;\n      this.$refs.commentInput.focus();\n    }\n  },\n  mounted() {\n    this.getLostFoundPage(this.param);\n  }\n}\n",{"version":3,"sources":["LostFound.vue"],"names":[],"mappings":";AAsKA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"LostFound.vue","sourceRoot":"src/views/lost-found","sourcesContent":["<template>\n  <div class=\"container\">\n    <Row>\n      <iCol class=\"column\" span=\"16\">\n        <!-- å¤±ç‰©å¯»ç‰©èœå• -->\n        <sui-menu>\n          <sui-menu-item link v-for=\"item in menu.items\" :key=\"item\" :content=\"item\"\n                         :active=\"item === menu.active\" @click=\"select(item)\"/>\n          <sui-menu-item position=\"right\">\n            <sui-input transparent icon=\"search\" placeholder=\"æœç´¢\"\n                       v-model=\"param.general\" @keydown.enter=\"getLostFoundPage(param)\"/>\n          </sui-menu-item>\n        </sui-menu>\n        <!-- å¤±ç‰©å¯»ç‰©èœå• END -->\n        <!-- å¤±ç‰©å¯»ç‰©åˆ—è¡¨ -->\n        <sui-card class=\"fluid lost-found-card\" v-for=\"lostFound in lostFoundPage.records\" :key=\"lostFound.id\">\n          <sui-card-content>\n            <sui-feed>\n              <sui-feed-event>\n                <sui-feed-content>\n                  <sui-feed-summary>\n                    <sui-label class=\"lost-found-category\" basic\n                               :color=\"lostFound.lostFoundCategory === 'å¯»ç‰©å¯äº‹'? 'red':'green'\">\n                      {{lostFound.lostFoundCategory}}\n                    </sui-label>\n                    <router-link class=\"lost-found-title\" :to=\"'/lost-found/' + lostFound.id\">{{lostFound.title}}\n                    </router-link>\n                    <sui-feed-date>\n                      <Time :time=\"lostFound.createTime\"/>\n                    </sui-feed-date>\n                  </sui-feed-summary>\n                  <sui-feed-extra class=\"lost-found-extra\" text>\n                    <Row>\n                      <iCol span=\"7\">ğŸ‘œ {{lostFound.itemName}}</iCol>\n                      <iCol span=\"9\">ğŸ•“ {{lostFound.time}}</iCol>\n                      <iCol span=\"5\" offset=\"3\">ğŸ“ {{lostFound.address}}</iCol>\n                    </Row>\n                    <div class=\"lost-found-description\">{{lostFound.description}}</div>\n                  </sui-feed-extra>\n                  <sui-feed-extra class=\"lost-found-images\" images\n                                  v-if=\"lostFound.images && lostFound.images.length > 0\">\n                    <img v-for=\"img in lostFound.images\" :src=\"img\">\n                  </sui-feed-extra>\n                  <sui-feed-meta>\n                    <router-link :to=\"'/user/' + lostFound.user.id\">\n                      <sui-image :src=\"lostFound.user.avatar\" size=\"medium\" avatar/>\n                      <span style=\"position: relative; top: 2px\">{{lostFound.user.nickname}}</span>\n                    </router-link>\n                    <sui-feed-like @click=\"addZan(lostFound.resource)\">\n                      ğŸ‘ {{lostFound.resource.zanCount}}\n                    </sui-feed-like>\n                    <sui-feed-like @click=\"getCommentList(lostFound.resource)\">\n                      ğŸ’¬ {{lostFound.resource.commentCount}}\n                    </sui-feed-like>\n                  </sui-feed-meta>\n                </sui-feed-content>\n              </sui-feed-event>\n            </sui-feed>\n          </sui-card-content>\n        </sui-card>\n        <!-- å¤±ç‰©å¯»ç‰©åˆ—è¡¨ END -->\n        <!-- åŠ è½½æ›´å¤š -->\n        <sui-button class=\"fluid\" basic content=\"åŠ è½½æ›´å¤š\" @click=\"loadMore\"\n                    :disabled=\"param.current >= lostFoundPage.pages\"/>\n        <!-- åŠ è½½æ›´å¤š END -->\n      </iCol>\n      <iCol class=\"column\" span=\"8\">\n        <!-- å¯»ç‰©å¯äº‹æç¤º -->\n        <sui-card class=\"fluid\">\n          <sui-message attached=\"top\" icon=\"eye\" negative>\n            <sui-message-header>å¯»ç‰©å¯äº‹å°è´´å£«</sui-message-header>\n            <p>ä»€ä¹ˆï¼Œæœ‰ä¸œè¥¿ä¸¢å•¦ï¼Ÿä¸è¦æ€•ï¼Œå¿«æ¥å‘å¸ƒä¸€æ¡å¯»ç‰©å¯äº‹å§ï¼Œå¾ˆå¿«å°±ä¼šæœ‰å¥½å¿ƒäººè”ç³»ä½ å•¦ã€‚å¯¹å•¦ï¼Œä¸€å®šè¦æ ¸å®ä¿¡æ¯ï¼Œå‡†ç¡®åå†å‘å¸ƒå“¦ ğŸ˜ƒ</p>\n          </sui-message>\n          <sui-button attached=\"bottom\" icon=\"add\" content=\"å‘å¸ƒå¯»ç‰©å¯äº‹\" @click=\"showLostFoundModal('å¯»ç‰©å¯äº‹')\"/>\n        </sui-card>\n        <!-- å¯»ç‰©å¯äº‹æç¤º END -->\n        <!-- å¤±ç‰©æ‹›é¢†æç¤º -->\n        <sui-card class=\"fluid\">\n          <sui-message attached=\"top\" icon=\"bullhorn\" positive>\n            <sui-message-content>\n              <sui-message-header>å¤±ç‰©æ‹›é¢†å°è´´å£«</sui-message-header>\n              <p>æ¡åˆ°å“ªä½åŒå­¦ä¸å°ä¿¡æ‰è½çš„ç‰©å“å•¦ï¼Ÿå¿«å‘å¸ƒä¸€æ¡å¤±ç‰©æ‹›é¢†å§ï¼Œå¤±ä¸»ä¸€å®šä¼šéå¸¸éå¸¸æ„Ÿæ¿€ä½ å‘¢ ğŸ˜˜</p>\n            </sui-message-content>\n          </sui-message>\n          <sui-button attached=\"bottom\" icon=\"add\" content=\"å‘å¸ƒå¤±ç‰©æ‹›é¢†\" @click=\"showLostFoundModal('å¤±ç‰©æ‹›é¢†')\"/>\n        </sui-card>\n        <!-- å¤±ç‰©æ‹›é¢†æç¤º END -->\n      </iCol>\n    </Row>\n    <!-- å¤±ç‰©å¯»ç‰©æ·»åŠ æ¨¡æ€æ¡† -->\n    <Modal v-model=\"lostFoundAddModal.show\" :title=\"lostFoundAddModal.title\" width=\"600\" scrollable>\n      <Form :model=\"lostFoundAddModal.form\" :label-width=\"50\">\n        <FormItem label=\"æ ‡é¢˜\" required>\n          <Input v-model=\"lostFoundAddModal.form.title\" size=\"large\" placeholder=\"æ¸…æ™°çš„æ ‡é¢˜èƒ½è®©æ›´å¤šäººæ³¨æ„åˆ°\"/>\n        </FormItem>\n        <FormItem label=\"ç‰©å“\" required>\n          <Input v-model=\"lostFoundAddModal.form.itemName\" size=\"large\" placeholder=\"è¯·å¡«å†™ç‰©å“å\"/>\n        </FormItem>\n        <FormItem label=\"æ—¶é—´\" required>\n          <DatePicker :value=\"lostFoundAddModal.form.time\" @on-change=\"time => lostFoundAddModal.form.time = time\"\n                      type=\"datetime\" size=\"large\" :placeholder=\"lostFoundAddModal.placeholder.time\"\n                      style=\"width: 100%\"/>\n        </FormItem>\n        <FormItem label=\"åœ°ç‚¹\" required>\n          <Input v-model=\"lostFoundAddModal.form.address\" size=\"large\"\n                 :placeholder=\"lostFoundAddModal.placeholder.address\"/>\n        </FormItem>\n        <FormItem label=\"æè¿°\" required>\n          <Input v-model=\"lostFoundAddModal.form.description\" type=\"textarea\" size=\"large\"\n                 :autosize=\"{minRows: 5,maxRows: 10}\" placeholder=\"è¾“å…¥ç‰©å“æè¿°ï¼Œæœ‰åŠ©äºä»–äººè·å–ä¿¡æ¯\"/>\n        </FormItem>\n        <FormItem label=\"å›¾ç‰‡\" style=\"margin-bottom: 0\">\n          <ImageUploader ref=\"imageUploader\" @images-change=\"images => lostFoundAddModal.form.images = images\"/>\n        </FormItem>\n      </Form>\n      <template #footer>\n        <Button type=\"text\" @click=\"lostFoundAddModal.show = false\">å–æ¶ˆ</Button>\n        <Button @click=\"addLostFound\">ç¡®å®šå‘å¸ƒ</Button>\n      </template>\n    </Modal>\n    <!-- å¤±ç‰©å¯»ç‰©æ·»åŠ æ¨¡æ€æ¡† END -->\n    <!-- è¯„è®ºæ¨¡æ€æ¡† -->\n    <Modal v-model=\"commentAddModal.show\" title=\"å‘è¡¨è¯„è®º\" width=\"600\" footer-hide>\n      <Input ref=\"commentInput\" v-model=\"commentAddModal.form.value\" type=\"textarea\" :rows=\"3\" placeholder=\"æ·»åŠ è¯„è®º\"\n             @on-enter=\"addComment\"/>\n      <sui-comment-group class=\"comment-group\">\n        <sui-comment v-for=\"comment in commentList\" :key=\"comment.id\">\n          <sui-comment-avatar :src=\"comment.postUser.avatar\"/>\n          <sui-comment-content>\n            <a is=\"sui-comment-author\">{{comment.postUser.nickname}}</a>\n            <sui-comment-metadata>\n              <Time :time=\"comment.createTime\"/>\n            </sui-comment-metadata>\n            <sui-comment-text>{{comment.content}}</sui-comment-text>\n            <sui-comment-actions>\n              <sui-comment-action @click=\"replyComment(comment.id, comment.postUser)\">å›å¤</sui-comment-action>\n            </sui-comment-actions>\n          </sui-comment-content>\n          <!-- å­è¯„è®º -->\n          <sui-comment-group v-if=\"comment.children.length > 0\">\n            <sui-comment v-for=\"child in comment.children\" :key=\"child.id\">\n              <sui-comment-avatar :src=\"child.postUser.avatar\"/>\n              <sui-comment-content>\n                <a is=\"sui-comment-author\">{{child.postUser.nickname}}</a>\n                <sui-comment-metadata>\n                  <Time :time=\"child.createTime\"/>\n                </sui-comment-metadata>\n                <sui-comment-text>\n                  <a :href=\"child.replyUser.id\">@{{child.replyUser.nickname}}</a>\n                  {{child.content}}\n                </sui-comment-text>\n                <sui-comment-actions>\n                  <sui-comment-action @click=\"replyComment(comment.id, child.postUser)\">å›å¤</sui-comment-action>\n                </sui-comment-actions>\n              </sui-comment-content>\n            </sui-comment>\n          </sui-comment-group>\n          <!-- å­è¯„è®º END -->\n        </sui-comment>\n      </sui-comment-group>\n    </Modal>\n    <!-- è¯„è®ºæ¨¡æ€æ¡† END -->\n  </div>\n</template>\n\n<script>\nimport ImageUploader from '@/components/common/ImageUploader'\n\nexport default {\n  name: 'LostFound',\n  components: {\n    ImageUploader\n  },\n  data() {\n    return {\n      menu: {\n        active: 'æŸ¥çœ‹æ‰€æœ‰',\n        items: ['æŸ¥çœ‹æ‰€æœ‰', 'å¤±ç‰©æ‹›é¢†', 'å¯»ç‰©å¯äº‹'],\n      },\n      param: {\n        // query å‚æ•°\n        lostFoundCategory: null,\n        general: null,\n        // page & order å‚æ•°\n        desc: 'create_time',\n        current: 1\n      },\n      lostFoundPage: {\n        'records': [\n          {\n            'id': 1,\n            'userId': 1,\n            'resourceId': 16,\n            'lostFoundCategory': 'å¯»ç‰©å¯äº‹',\n            'title': 'å››é£Ÿå ‚ä¸¢å¤±ä¸€ä¸ªé’±åŒ…',\n            'description': 'å¦‚å›¾ï¼Œé’±åŒ…æ˜¯é»‘è‰²çš„ï¼Œé‡Œé¢æœ‰å°‘é‡ç°é‡‘å’Œä¸€å¼ å·¥è¡Œçš„å¡',\n            'itemName': 'é’±åŒ…',\n            'time': '2024-05-17 12:10:01',\n            'address': 'å››é£Ÿå ‚',\n            'createTime': '2024-05-17 15:39:45',\n            'images': ['https://img12.360buyimg.com/n7/jfs/t22831/61/2367409622/289066/5d9c3f/5b7d10feNe776b305.jpg'],\n            'user': {\n              'id': 1,\n              'username': 'admin',\n              'nickname': 'ç®¡ç†å‘˜',\n              'avatar': 'http://img.angus-liu.cn/avatar/avatar07.png',\n              'sign': 'ä¸€å¥è¯ä»‹ç»è‡ªå·±'\n            },\n            'resource': {\n              'id': 16,\n              'zanCount': 0,\n              'pvCount': 0,\n              'commentCount': 0\n            }\n          }\n        ],\n        'total': 5,\n        'size': 1,\n        'current': 1,\n        'searchCount': true,\n        'pages': 5\n      },\n      lostFoundAddModal: {\n        show: false,\n        title: 'å‘å¸ƒå¯»ç‰©å¯äº‹',\n        placeholder: {\n          time: 'è¯·é€‰æ‹©ä¸¢å¤±æ—¶é—´',\n          address: 'è¯·å¡«å†™ä¸¢å¤±åœ°ç‚¹'\n        },\n        form: {\n          lostFoundCategory: 'å¯»ç‰©å¯äº‹',\n          title: '',\n          itemName: '',\n          time: null,\n          address: '',\n          description: '',\n          images: null,\n        }\n      },\n      commentList: [{\n        id: -1,\n        content: 'æµ‹è¯•è¯„è®º',\n        createTime: '2024-05-21 20:15:39',\n        postUser: {\n          id: -1,\n          username: 'admin',\n          nickname: 'ç®¡ç†å‘˜',\n          avatar: 'http://img.angus-liu.cn/avatar/avatar07.png'\n        },\n        children: [\n          {\n            id: -2,\n            content: 'æµ‹è¯•å›å¤',\n            createTime: '2024-05-21 20:15:46',\n            postUser: {\n              id: 1,\n              username: 'admin',\n              nickname: 'ç®¡ç†å‘˜',\n              avatar: 'http://img.angus-liu.cn/avatar/avatar07.png'\n            },\n            replyUser: {\n              id: 1,\n              username: 'admin',\n              nickname: 'ç®¡ç†å‘˜',\n              avatar: 'http://img.angus-liu.cn/avatar/avatar07.png'\n            }\n          }\n        ]\n      }],\n      commentAddModal: {\n        show: false,\n        form: {\n          parentId: null,\n          resourceId: null,\n          replyUserId: null,\n          value: '',\n          content: ''\n        }\n      },\n      currentResource: {}\n    }\n  },\n  methods: {\n    // åˆ‡æ¢èœå•\n    select(item) {\n      this.menu.active = item;\n      switch (item) {\n        case 'æŸ¥çœ‹æ‰€æœ‰':\n          this.param.lostFoundCategory = null;\n          break;\n        case 'å¤±ç‰©æ‹›é¢†':\n          this.param.lostFoundCategory = 'å¤±ç‰©æ‹›é¢†';\n          break;\n        case 'å¯»ç‰©å¯äº‹':\n          this.param.lostFoundCategory = 'å¯»ç‰©å¯äº‹';\n          break;\n      }\n      this.param.current = 1;\n      this.getLostFoundPage(this.param);\n    },\n    // è·å–å¤±ç‰©å¯»ç‰©åˆ†é¡µ\n    getLostFoundPage(param) {\n      this.$axios.get('/api/lost-found/page', param)\n        .then(res => {\n          let result = res.data;\n          this.lostFoundPage = result.data;\n          this.lostFoundPage.records.forEach(lostFound => {\n            if (lostFound.images && lostFound.images.length > 0) {\n              lostFound.images = JSON.parse(lostFound.images);\n            }\n          })\n        })\n    },\n    // é…ç½®å¤±ç‰©å¯»ç‰©æ·»åŠ æ¨¡æ€æ¡†\n    showLostFoundModal(type) {\n      if (type === 'å¯»ç‰©å¯äº‹') {\n        this.lostFoundAddModal = {\n          show: true,\n          title: 'å‘å¸ƒå¯»ç‰©å¯äº‹',\n          placeholder: {\n            time: 'è¯·é€‰æ‹©ä¸¢å¤±æ—¶é—´',\n            address: 'è¯·å¡«å†™ä¸¢å¤±åœ°ç‚¹'\n          },\n          form: {\n            lostFoundCategory: 'å¯»ç‰©å¯äº‹',\n            title: '',\n            itemName: '',\n            time: null,\n            address: '',\n            description: '',\n            images: null,\n          }\n        }\n      } else {\n        this.lostFoundAddModal = {\n          show: true,\n          title: 'å‘å¸ƒå¤±ç‰©æ‹›é¢†',\n          placeholder: {\n            time: 'è¯·é€‰æ‹©æ‹¾å–æ—¶é—´',\n            address: 'è¯·å¡«å†™æ‹¾å–åœ°ç‚¹'\n          },\n          form: {\n            lostFoundCategory: 'å¤±ç‰©æ‹›é¢†',\n            title: '',\n            itemName: '',\n            time: null,\n            address: '',\n            description: '',\n            images: null,\n          }\n        }\n      }\n    },\n    // æ·»åŠ å¤±ç‰©å¯»ç‰©\n    addLostFound() {\n      let lostFoundAddForm = this.lostFoundAddModal.form;\n      lostFoundAddForm.images = JSON.stringify(lostFoundAddForm.images);\n      this.$axios.post('/api/lost-found', lostFoundAddForm)\n        .then(res => {\n          let result = res.data;\n          if (result.success) {\n            this.$Notice.success({ title: 'Bingo', desc: 'å‘å¸ƒæˆåŠŸ' });\n            this.lostFoundAddModal.show = false;\n            this.$refs.imageUploader.clearImages();\n            this.getLostFoundPage(this.param);\n          }\n        });\n    },\n    // åŠ è½½æ›´å¤š\n    loadMore() {\n      this.param.current++;\n      this.$axios.get('/api/lost-found/page', this.param)\n        .then(res => {\n          let result = res.data;\n          let moreLostFoundPage = result.data;\n          moreLostFoundPage.records.forEach(lostFound => {\n            if (lostFound.images && lostFound.images.length > 0) {\n              lostFound.images = JSON.parse(lostFound.images);\n            }\n          });\n          this.lostFoundPage.records.push(...moreLostFoundPage.records);\n        });\n    },\n    // ç‚¹èµ\n    addZan(resource) {\n      this.$axios.post('/api/zan', { resourceId: resource.id })\n        .then(res => resource.zanCount++);\n    },\n    // è·å–è¯„è®º\n    getCommentList(resource) {\n      this.currentResource = resource;\n      this.$axios.get(`/api/comment/${resource.id}`)\n        .then(res => {\n          let result = res.data;\n          this.commentList = result.data;\n          // å±•ç¤ºè¯„è®º\n          this.commentAddModal.show = true;\n        });\n    },\n    // åˆå§‹åŒ–è¯„è®º\n    initComment() {\n      this.commentAddModal.form = {\n        resourceId: null,\n        parentId: null,\n        replyUserId: null,\n        value: '',\n        content: ''\n      }\n    },\n    // æ·»åŠ è¯„è®º\n    addComment() {\n      // è®¾ç½®èµ„æº ID\n      this.commentAddModal.form.resourceId = this.currentResource.id;\n      // åˆ¤æ–­æ˜¯è¯„è®ºè¿˜æ˜¯å›å¤\n      if (this.commentAddModal.form.value.startsWith('@')\n        && this.commentAddModal.form.replyUserId !== null) {\n        // å›å¤æ—¶å»æ‰è¯„è®ºå†…å®¹ä¸­çš„å›å¤ç”¨æˆ·å\n        let index = this.commentAddModal.form.value.indexOf(' ');\n        this.commentAddModal.form.content = this.commentAddModal.form.value.substr(index + 1);\n      } else {\n        this.commentAddModal.form.parentId = null;\n        this.commentAddModal.form.replyUserId = null;\n        this.commentAddModal.form.content = this.commentAddModal.form.value;\n      }\n      this.$axios.post('/api/comment', this.commentAddModal.form)\n        .then(res => {\n          this.initComment();\n          this.currentResource.commentCount++;\n          this.getCommentList(this.currentResource);\n        });\n    },\n    // å›å¤è¯„è®º\n    replyComment(parentId, replyUser) {\n      this.commentAddModal.form.parentId = parentId;\n      this.commentAddModal.form.replyUserId = replyUser.id;\n      this.commentAddModal.form.value = `@${replyUser.nickname} `;\n      this.$refs.commentInput.focus();\n    }\n  },\n  mounted() {\n    this.getLostFoundPage(this.param);\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.container {\n  width: 1140px;\n  margin: 0 auto;\n  padding: 5px;\n\n  .column {\n    padding: 7px;\n  }\n\n  .lost-found-card {\n    .lost-found-category {\n      margin-right: 5px;\n    }\n\n    a.lost-found-title {\n      color: #455A64;\n    }\n\n    a.lost-found-title:hover {\n      color: #FF8364;\n    }\n\n    .lost-found-extra {\n      width: 100%;\n\n      .lost-found-description {\n        margin: 10px 0;\n        color: #444;\n      }\n    }\n  }\n}\n</style>\n"]}]}