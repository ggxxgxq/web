{"remainingRequest":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/src/views/article/Editor.vue?vue&type=style&index=0&id=686c0260&lang=less&scoped=true","dependencies":[{"path":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/src/views/article/Editor.vue","mtime":1712587400026},{"path":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/node_modules/css-loader/index.js","mtime":1712590522695},{"path":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1712590523760},{"path":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/node_modules/postcss-loader/src/index.js","mtime":1712590523260},{"path":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/node_modules/less-loader/dist/cjs.js","mtime":1712590524064},{"path":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/node_modules/cache-loader/dist/cjs.js","mtime":1712590523146},{"path":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/node_modules/vue-loader/lib/index.js","mtime":1712590523434}],"contextDependencies":[],"result":["\n.container {\n  height: 100%;\n  width: 1260px;\n  margin: 20px auto;\n\n  .article-info-title {\n    margin-bottom: 7px;\n  }\n\n  .editor {\n    height: 780px;\n    z-index: 1;\n  }\n\n  .fullscreen {\n    height: 100%;\n    z-index: 100;\n  }\n}\n\n.article-info-row {\n  margin-bottom: 10px;\n\n  .article-info-tag {\n    margin-bottom: 5px;\n  }\n}\n",{"version":3,"sources":["Editor.vue"],"names":[],"mappings":";AA4IA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA","file":"Editor.vue","sourceRoot":"src/views/article","sourcesContent":["<template>\n  <div class=\"container\">\n    <!-- 标题 -->\n    <div class=\"article-info-title\">\n      <Input v-model=\"articleAddForm.title\" placeholder=\"输入文章标题\" size=\"large\" style=\"z-index: 1\">\n        <template #append>\n          <Button icon=\"md-create\" @click=\"articleInfoModal.show = true\">提交</Button>\n        </template>\n      </Input>\n    </div>\n    <!-- 标题 END -->\n    <!-- 文章信息模态框 -->\n    <Modal v-model=\"articleInfoModal.show\" title=\"文章信息\" :mask-closable=\"false\" :width=\"600\" scrollable>\n      <Row>\n        <iCol span=\"8\">\n          <sui-image :src=\"articleAddForm.cover\" size=\"medium\" rounded/>\n          <Upload action=\"//jsonplaceholder.typicode.com/posts/\">\n            <Button icon=\"ios-cloud-upload-outline\">上传文章封面</Button>\n          </Upload>\n        </iCol>\n        <iCol span=\"16\">\n          <div class=\"article-info-row\">\n            <Select v-model=\"articleAddForm.articleCategory\" placeholder=\"请选择文章类别\" size=\"large\">\n              <Option v-for=\"item in articleCategory\" :key=\"item.name\" :value=\"item.name\" :label=\"item.name\"/>\n            </Select>\n          </div>\n          <div class=\"article-info-row\">\n            <Input type=\"textarea\" v-model=\"articleAddForm.brief\" size=\"large\" :autosize=\"{minRows: 5,maxRows: 10}\"\n                   placeholder=\"请输入文章简介\"/>\n          </div>\n          <div class=\"article-info-row\">\n            <Input class=\"article-info-tag\" prefix=\"ios-bookmark-outline\" v-model=\"tag\" placeholder=\"添加标签\"\n                   @on-enter=\"addTag\"/>\n            <Tag class=\"article-info-tag\" v-for=\"(item, index) in tags\" :key=\"index\" :name=\"item\"\n                 @on-close=\"removeTag\" closable type=\"dot\" color=\"primary\">\n              {{item}}\n            </Tag>\n          </div>\n        </iCol>\n      </Row>\n      <template #footer>\n        <Button type=\"text\" @click=\"articleInfoModal.show = false\">取消</Button>\n        <Button type=\"primary\" @click=\"submitArticle\" :loading=\"articleInfoModal.loading\">确认提交</Button>\n      </template>\n    </Modal>\n    <!-- 文章信息模态框 END -->\n    <!-- 编辑器 -->\n    <mavon-editor class=\"editor\" ref=editor v-model=\"articleAddForm.markdownContent\"\n                  @change=\"contentChange\" @imgAdd=\"imgAdd\" :boxShadow=\"false\"/>\n    <!-- 编辑器 END -->\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'Editor',\n  data() {\n    return {\n      articleInfoModal: {\n        show: false,\n        loading: false\n      },\n      tag: '',\n      tags: [],\n      articleCategory: [{\n        name: '测试类别',\n        code: '-1'\n      }],\n      articleAddForm: {\n        articleCategory: '',\n        title: '',\n        brief: '',\n        cover: 'http://img.angus-liu.cn/avatar/avatar01.jpg',\n        tags: '',\n        markdownContent: '',\n        htmlContent: ''\n      }\n    };\n  },\n  methods: {\n    // 获取文章类别\n    getArticleCategory() {\n      this.$axios.get('/api/dic/item', { dicTypeCode: 'article-category' })\n        .then(res => {\n          let result = res.data;\n          this.articleCategory = result.data;\n        })\n    },\n    // 编辑器内容变化\n    contentChange(value, render) {\n      this.articleAddForm.markdownContent = value;\n      this.articleAddForm.htmlContent = render;\n    },\n    // 保存草稿\n    saveArticle(value, render) {\n      console.log('保存草稿');\n    },\n    // 添加图片\n    imgAdd(pos, img){\n      // 第一步.将图片上传到服务器.\n      let formData = new FormData();\n      formData.append('type', 'img');\n      formData.append('file', img);\n      this.$axios.post('/api/local-storage/upload', formData)\n        .then(res => {\n        let result = res.data;\n        this.$refs.editor.$img2Url(pos, result.data.url);\n      })\n    },\n    // 添加标签\n    addTag() {\n      this.tags.push(this.tag);\n      this.tag = '';\n    },\n    removeTag(event, name) {\n      const index = this.tags.indexOf(name);\n      this.tags.splice(index, 1);\n    },\n    submitArticle() {\n      this.articleInfoModal.loading = true;\n      this.articleAddForm.tags = JSON.stringify(this.tags);\n      this.$axios.post('/api/article', this.articleAddForm)\n        .then(res => {\n          this.articleInfoModal.show = false;\n          this.articleInfoModal.loading = false;\n          this.$Notice.success({ title: 'Bingo', desc: '发布成功' });\n          this.$router.push('/');\n        })\n        .catch(error => {\n          this.articleInfoModal.loading = false;\n        });\n    }\n  },\n  mounted() {\n    this.getArticleCategory();\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n.container {\n  height: 100%;\n  width: 1260px;\n  margin: 20px auto;\n\n  .article-info-title {\n    margin-bottom: 7px;\n  }\n\n  .editor {\n    height: 780px;\n    z-index: 1;\n  }\n\n  .fullscreen {\n    height: 100%;\n    z-index: 100;\n  }\n}\n\n.article-info-row {\n  margin-bottom: 10px;\n\n  .article-info-tag {\n    margin-bottom: 5px;\n  }\n}\n</style>\n"]}]}