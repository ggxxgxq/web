{"remainingRequest":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/node_modules/babel-loader/lib/index.js!/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/src/views/file/Detail.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/src/views/file/Detail.vue","mtime":1712673875734},{"path":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/babel.config.js","mtime":1712587400021},{"path":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/node_modules/cache-loader/dist/cjs.js","mtime":1712590523146},{"path":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/node_modules/babel-loader/lib/index.js","mtime":1712590523266},{"path":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/node_modules/cache-loader/dist/cjs.js","mtime":1712590523146},{"path":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/node_modules/vue-loader/lib/index.js","mtime":1712590523434}],"contextDependencies":[],"result":["import \"core-js/modules/es6.string.starts-with\";\nexport default {\n  name: 'Detail',\n  props: ['id'],\n  data: function data() {\n    return {\n      // 文件信息\n      file: {\n        'id': 1,\n        'userId': 1,\n        'resourceId': 2,\n        'fileCategory': '计算机',\n        'title': '计算机类全套PPT，你值得拥有',\n        'description': '计算机类全套PPT，你值得拥有',\n        'name': '中北大学计算机类.ppt',\n        'size': '200MB',\n        'url': 'http://bkt.angus-liu.cn/中北大学计算机类.ppt',\n        'downloadCount': 0,\n        'createTime': '2024-05-13 09:18:13',\n        'user': {\n          'id': 1,\n          'username': 'admin',\n          'nickname': '文刀',\n          'avatar': 'http://img.angus-liu.cn/avatar/avatar07.png',\n          'sign': '终其一生，我们都在自我救赎'\n        },\n        'resource': {\n          'id': 2,\n          'zanCount': 1,\n          'pvCount': 0,\n          'commentCount': 2\n        }\n      },\n      // 评论信息\n      commentList: [{\n        id: -1,\n        content: '测试评论',\n        createTime: '2024-05-21 20:15:39',\n        postUser: {\n          id: -1,\n          username: 'admin',\n          nickname: '管理员',\n          avatar: 'http://img.angus-liu.cn/avatar/avatar07.png'\n        },\n        children: [{\n          id: -2,\n          content: '测试回复',\n          createTime: '2024-05-21 20:15:46',\n          postUser: {\n            id: 1,\n            username: 'admin',\n            nickname: '管理员',\n            avatar: 'http://img.angus-liu.cn/avatar/avatar07.png'\n          },\n          replyUser: {\n            id: 1,\n            username: 'admin',\n            nickname: '管理员',\n            avatar: 'http://img.angus-liu.cn/avatar/avatar07.png'\n          }\n        }]\n      }],\n      comment: {\n        parentId: null,\n        resourceId: null,\n        replyUserId: null,\n        value: '',\n        content: ''\n      }\n    };\n  },\n  methods: {\n    // 获取文件信息\n    getFile: function getFile() {\n      var _this = this;\n      this.$axios.get(\"/api/file/\".concat(this.id)).then(function (res) {\n        var result = res.data;\n        _this.file = result.data;\n        // 获取评论信息\n        _this.getCommentList();\n      });\n    },\n    // 获取评论信息\n    getCommentList: function getCommentList() {\n      var _this2 = this;\n      this.$axios.get(\"/api/comment/\".concat(this.file.resourceId)).then(function (res) {\n        var result = res.data;\n        _this2.commentList = result.data;\n      });\n    },\n    // 初始化评论\n    initComment: function initComment() {\n      this.comment = {\n        resourceId: null,\n        parentId: null,\n        replyUserId: null,\n        value: '',\n        content: ''\n      };\n    },\n    // 添加评论\n    addComment: function addComment() {\n      var _this3 = this;\n      this.comment.resourceId = this.file.resourceId;\n      // 判断是评论还是回复\n      if (this.comment.value.startsWith('@') && this.comment.replyUserId !== null) {\n        // 回复时去掉评论内容中的回复用户名\n        var index = this.comment.value.indexOf(' ');\n        this.comment.content = this.comment.value.substr(index + 1);\n      } else {\n        this.comment.parentId = null;\n        this.comment.replyUserId = null;\n        this.comment.content = this.comment.value;\n      }\n      this.$axios.post('/api/comment', this.comment).then(function (res) {\n        _this3.initComment();\n        _this3.getCommentList();\n        _this3.file.resource.commentCount++;\n      });\n    },\n    // 回复评论\n    replyComment: function replyComment(parentId, replyUser) {\n      this.comment.parentId = parentId;\n      this.comment.replyUserId = replyUser.id;\n      this.comment.value = \"@\".concat(replyUser.nickname, \" \");\n      this.$refs.commentInput.focus();\n    },\n    // 文件下载\n    downloadFile: function downloadFile(file) {\n      this.$axios.put(\"/api/file/\".concat(file.id, \"/download-count\")).then(function (res) {\n        return file.downloadCount++;\n      });\n    },\n    // 点赞\n    addZan: function addZan(resource) {\n      this.$axios.post('/api/zan', {\n        resourceId: resource.id\n      }).then(function (res) {\n        return resource.zanCount++;\n      });\n    }\n  },\n  mounted: function mounted() {\n    this.getFile();\n  }\n};",{"version":3,"names":["name","props","data","file","commentList","id","content","createTime","postUser","username","nickname","avatar","children","replyUser","comment","parentId","resourceId","replyUserId","value","methods","getFile","_this","$axios","get","concat","then","res","result","getCommentList","_this2","initComment","addComment","_this3","startsWith","index","indexOf","substr","post","resource","commentCount","replyComment","$refs","commentInput","focus","downloadFile","put","downloadCount","addZan","zanCount","mounted"],"sources":["src/views/file/Detail.vue"],"sourcesContent":["<template>\n  <div class=\"container\">\n    <Row>\n      <iCol span=\"18\">\n        <article>\n          <!-- 文件信息 -->\n          <sui-card class=\"fluid file-card\">\n            <sui-message attached=\"top\">\n              文件详情\n            </sui-message>\n            <sui-card-content class=\"file-content\">\n\n              <sui-card-header>\n                {{file.title}}\n                <sui-label basic color=\"teal\">{{file.fileCategory}}</sui-label>\n              </sui-card-header>\n              <p>下载链接：<a :href=\"file.url\" :download=\"file.name\" @click=\"downloadFile(file)\">{{file.name}}</a></p>\n              <p>文件大小：{{file.size}}</p>\n              <p>上传日期：\n                <Time :time=\"file.createTime\"/>\n              </p>\n              <sui-card-description>\n                {{file.description}}\n              </sui-card-description>\n\n              <!-- 评论列表 -->\n              <div class=\"file-comment\">\n                <!-- 评论框 -->\n                <sui-form class=\"comment-input-form\">\n                  <sui-form-field>\n                    <Input ref=\"commentInput\" v-model=\"comment.value\" type=\"textarea\" :rows=\"3\" placeholder=\"添加评论\"\n                           @keydown.ctrl.enter.native=\"addComment\"/>\n                  </sui-form-field>\n                  <sui-form-field>\n                    <span class=\"resource-info-item\">\n                      ⏬ {{file.downloadCount}}\n                    </span>\n                    <span class=\"resource-info-item\" @click=\"addZan(file.resource)\">\n                      👍 {{file.resource.zanCount}}\n                    </span>\n                    <span class=\"resource-info-item\">\n                      💬 {{file.resource.commentCount}}\n                    </span>\n                    <sui-button basic floated=\"right\" content=\"评论(Ctrl+Enter)\" @click.prevent=\"addComment\"/>\n                  </sui-form-field>\n                </sui-form>\n                <!-- 评论框END -->\n                <!-- 父评论 -->\n                <sui-comment-group>\n                  <sui-comment v-for=\"comment in commentList\" :key=\"comment.id\">\n                    <sui-comment-avatar :src=\"comment.postUser.avatar\"/>\n                    <sui-comment-content>\n                      <a is=\"sui-comment-author\">{{comment.postUser.nickname}}</a>\n                      <sui-comment-metadata>\n                        <Time :time=\"comment.createTime\"/>\n                      </sui-comment-metadata>\n                      <sui-comment-text>{{comment.content}}</sui-comment-text>\n                      <sui-comment-actions>\n                        <sui-comment-action @click=\"replyComment(comment.id, comment.postUser)\">回复</sui-comment-action>\n                      </sui-comment-actions>\n                    </sui-comment-content>\n                    <!-- 子评论 -->\n                    <sui-comment-group v-if=\"comment.children.length > 0\">\n                      <sui-comment v-for=\"child in comment.children\" :key=\"child.id\">\n                        <sui-comment-avatar :src=\"child.postUser.avatar\"/>\n                        <sui-comment-content>\n                          <a is=\"sui-comment-author\">{{child.postUser.nickname}}</a>\n                          <sui-comment-metadata>\n                            <Time :time=\"child.createTime\"/>\n                          </sui-comment-metadata>\n                          <sui-comment-text>\n                            <a :href=\"child.replyUser.id\">@{{child.replyUser.nickname}}</a>\n                            {{child.content}}\n                          </sui-comment-text>\n                          <sui-comment-actions>\n                            <sui-comment-action @click=\"replyComment(comment.id, child.postUser)\">回复\n                            </sui-comment-action>\n                          </sui-comment-actions>\n                        </sui-comment-content>\n                      </sui-comment>\n                    </sui-comment-group>\n                    <!-- 子评论 END -->\n                  </sui-comment>\n                </sui-comment-group>\n                <!-- 父评论 END -->\n              </div>\n              <!-- 评论列表 END -->\n            </sui-card-content>\n          </sui-card>\n          <!-- 文件信息 END -->\n        </article>\n      </iCol>\n      <iCol span=\"6\">\n        <!-- 发布用户信息 -->\n        <sui-card class=\"fluid user-info-card\">\n          <sui-image style=\"width: 100%;\" :src=\"file.user.avatar\"/>\n          <sui-card-content>\n            <sui-card-header>\n              <router-link :to=\"'/user/' + file.user.id\">\n                {{file.user.nickname}}\n              </router-link>\n            </sui-card-header>\n            <sui-card-meta>{{file.user.username}}</sui-card-meta>\n            <sui-card-description>{{file.user.sign}}</sui-card-description>\n          </sui-card-content>\n          <sui-card-content extra>\n            <sui-icon name=\"user\"/>\n            发布用户\n          </sui-card-content>\n        </sui-card>\n        <!-- 发布用户信息 END -->\n        <!-- 操作按钮 -->\n        <div class=\"actions-buttons\" v-if=\"$store.state.user && file.userId === $store.state.user.id\">\n          <sui-button-group>\n            <sui-button icon=\"pencil\" content=\"编辑\" basic positive fluid/>\n            <sui-button icon=\"delete\" content=\"删除\" basic negative fluid/>\n          </sui-button-group>\n        </div>\n        <!-- 操作按钮 END -->\n        <!-- 相关文件 -->\n        <sui-card class=\"fluid\">\n          <sui-message attached=\"top\" content=\"他的文件\"/>\n          <sui-card-content>\n            暂无更多文件\n          </sui-card-content>\n        </sui-card>\n        <!-- 相关文件 END -->\n      </iCol>\n    </Row>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'Detail',\n  props: ['id'],\n  data() {\n    return {\n      // 文件信息\n      file: {\n        'id': 1,\n        'userId': 1,\n        'resourceId': 2,\n        'fileCategory': '计算机',\n        'title': '计算机类全套PPT，你值得拥有',\n        'description': '计算机类全套PPT，你值得拥有',\n        'name': '中北大学计算机类.ppt',\n        'size': '200MB',\n        'url': 'http://bkt.angus-liu.cn/中北大学计算机类.ppt',\n        'downloadCount': 0,\n        'createTime': '2024-05-13 09:18:13',\n        'user': {\n          'id': 1,\n          'username': 'admin',\n          'nickname': '文刀',\n          'avatar': 'http://img.angus-liu.cn/avatar/avatar07.png',\n          'sign': '终其一生，我们都在自我救赎'\n        },\n        'resource': {\n          'id': 2,\n          'zanCount': 1,\n          'pvCount': 0,\n          'commentCount': 2\n        }\n      },\n      // 评论信息\n      commentList: [{\n        id: -1,\n        content: '测试评论',\n        createTime: '2024-05-21 20:15:39',\n        postUser: {\n          id: -1,\n          username: 'admin',\n          nickname: '管理员',\n          avatar: 'http://img.angus-liu.cn/avatar/avatar07.png'\n        },\n        children: [\n          {\n            id: -2,\n            content: '测试回复',\n            createTime: '2024-05-21 20:15:46',\n            postUser: {\n              id: 1,\n              username: 'admin',\n              nickname: '管理员',\n              avatar: 'http://img.angus-liu.cn/avatar/avatar07.png'\n            },\n            replyUser: {\n              id: 1,\n              username: 'admin',\n              nickname: '管理员',\n              avatar: 'http://img.angus-liu.cn/avatar/avatar07.png'\n            }\n          }\n        ]\n      }],\n      comment: {\n        parentId: null,\n        resourceId: null,\n        replyUserId: null,\n        value: '',\n        content: ''\n      }\n    };\n  },\n  methods: {\n    // 获取文件信息\n    getFile() {\n      this.$axios.get(`/api/file/${this.id}`)\n        .then(res => {\n          let result = res.data;\n          this.file = result.data;\n          // 获取评论信息\n          this.getCommentList();\n        });\n    },\n    // 获取评论信息\n    getCommentList() {\n      this.$axios.get(`/api/comment/${this.file.resourceId}`)\n        .then(res => {\n          let result = res.data;\n          this.commentList = result.data;\n        });\n    },\n    // 初始化评论\n    initComment() {\n      this.comment = {\n        resourceId: null,\n        parentId: null,\n        replyUserId: null,\n        value: '',\n        content: ''\n      }\n    },\n    // 添加评论\n    addComment() {\n      this.comment.resourceId = this.file.resourceId;\n      // 判断是评论还是回复\n      if (this.comment.value.startsWith('@') && this.comment.replyUserId !== null) {\n        // 回复时去掉评论内容中的回复用户名\n        let index = this.comment.value.indexOf(' ');\n        this.comment.content = this.comment.value.substr(index + 1);\n      } else {\n        this.comment.parentId = null;\n        this.comment.replyUserId = null;\n        this.comment.content = this.comment.value;\n      }\n      this.$axios.post('/api/comment', this.comment)\n        .then(res => {\n          this.initComment();\n          this.getCommentList();\n          this.file.resource.commentCount++;\n        });\n    },\n    // 回复评论\n    replyComment(parentId, replyUser) {\n      this.comment.parentId = parentId;\n      this.comment.replyUserId = replyUser.id;\n      this.comment.value = `@${replyUser.nickname} `;\n      this.$refs.commentInput.focus();\n    },\n    // 文件下载\n    downloadFile(file) {\n      this.$axios.put(`/api/file/${file.id}/download-count`)\n        .then(res => file.downloadCount++);\n    },\n    // 点赞\n    addZan(resource) {\n      this.$axios.post('/api/zan', { resourceId: resource.id })\n        .then(res => resource.zanCount++);\n    }\n  },\n  mounted() {\n    this.getFile();\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n.container {\n  width: 1140px;\n  margin: 0 auto;\n  padding: 5px;\n\n  .ivu-col {\n    padding: 7px;\n  }\n}\n\n.file-card {\n  margin-bottom: 10px;\n\n  .file-content {\n    padding: 2em 3em;\n  }\n\n  .resource-info-item {\n    margin-right: 15px;\n    cursor: pointer;\n  }\n\n  .resource-info-item:hover {\n    color: #ff8364;\n  }\n\n  .file-comment {\n    padding-top: 2em;\n\n    .comment-input-form {\n      overflow: hidden;\n    }\n  }\n}\n\n.user-info-card {\n  .header {\n    a {\n      color: #373737;\n    }\n  }\n}\n\n.actions-buttons {\n  text-align: center;\n\n  .button {\n    width: 134px;\n  }\n}\n</style>\n"],"mappings":"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","ignoreList":[]}]}