{"remainingRequest":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/node_modules/babel-loader/lib/index.js!/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/src/views/file/File.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/src/views/file/File.vue","mtime":1712587400026},{"path":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/babel.config.js","mtime":1712587400021},{"path":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/node_modules/cache-loader/dist/cjs.js","mtime":1712590523146},{"path":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/node_modules/babel-loader/lib/index.js","mtime":1712590523266},{"path":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/node_modules/cache-loader/dist/cjs.js","mtime":1712590523146},{"path":"/Users/gaoxiangqing/Documents/gaoxiangqing/smilcool/smilcool-client/node_modules/vue-loader/lib/index.js","mtime":1712590523434}],"contextDependencies":[],"result":["import \"core-js/modules/es6.string.starts-with\";\nimport \"core-js/modules/es6.function.name\";\nexport default {\n  name: 'File',\n  data: function data() {\n    return {\n      menu: {\n        active: '最新',\n        items: ['最新', '最热']\n      },\n      localStorage: '/api/local-storage/upload',\n      activeFileCategory: '所有',\n      fileCategory: [{\n        name: '测试',\n        code: 'test'\n      }],\n      param: {\n        // 查询参数\n        fileCategory: null,\n        general: null,\n        // page & order 参数\n        desc: 'create_time',\n        current: 1\n      },\n      filePage: {\n        'records': [{\n          'id': 1,\n          'userId': 1,\n          'resourceId': 2,\n          'fileCategory': '计算机类',\n          'title': '计算机类全套PPT，你值得拥有',\n          'description': '计算机类全套PPT，你值得拥有',\n          'name': '中北大学计算机类.ppt',\n          'size': '200MB',\n          'url': 'http://bkt.angus-liu.cn/中北大学计算机类.ppt',\n          'downloadCount': 0,\n          'createTime': '2019-05-13 09:18:13',\n          'user': {\n            'id': 1,\n            'username': 'admin',\n            'nickname': '管理员',\n            'avatar': 'http://img.angus-liu.cn/avatar/avatar07.png',\n            'sign': '一句话介绍自己'\n          },\n          'resource': {\n            'id': 2,\n            'zanCount': 0,\n            'pvCount': 0,\n            'commentCount': 0\n          }\n        }],\n        'total': 10,\n        'size': 10,\n        'current': 1,\n        'searchCount': true,\n        'pages': 1\n      },\n      fileAddModal: {\n        show: false,\n        form: {\n          fileCategory: '',\n          title: '',\n          description: '',\n          name: '',\n          size: '',\n          url: ''\n        }\n      },\n      commentList: [{\n        id: -1,\n        content: '测试评论',\n        createTime: '2019-05-21 20:15:39',\n        postUser: {\n          id: -1,\n          username: 'admin',\n          nickname: '管理员',\n          avatar: 'http://img.angus-liu.cn/avatar/avatar07.png'\n        },\n        children: [{\n          id: -2,\n          content: '测试回复',\n          createTime: '2019-05-21 20:15:46',\n          postUser: {\n            id: 1,\n            username: 'admin',\n            nickname: '管理员',\n            avatar: 'http://img.angus-liu.cn/avatar/avatar07.png'\n          },\n          replyUser: {\n            id: 1,\n            username: 'admin',\n            nickname: '管理员',\n            avatar: 'http://img.angus-liu.cn/avatar/avatar07.png'\n          }\n        }]\n      }],\n      commentAddModal: {\n        show: false,\n        form: {\n          parentId: null,\n          resourceId: null,\n          replyUserId: null,\n          value: '',\n          content: ''\n        }\n      },\n      currentResource: {}\n    };\n  },\n  methods: {\n    // 菜单切换\n    select: function select(item) {\n      this.menu.active = item;\n      if (item === '最新') {\n        this.param.desc = 'create_time';\n      } else {\n        this.param.desc = 'download_count, comment_count, zan_count';\n      }\n      this.param.current = 1;\n      this.getFilePage(this.param);\n    },\n    // 类别切换\n    selectCategory: function selectCategory(fileCategory) {\n      this.activeFileCategory = fileCategory;\n      if (fileCategory === '所有') {\n        this.param.fileCategory = null;\n      } else {\n        this.param.fileCategory = fileCategory;\n      }\n      this.param.current = 1;\n      this.getFilePage(this.param);\n    },\n    // 初始化文件添加模态框\n    resetFileAddModal: function resetFileAddModal() {\n      this.fileAddModal = {\n        show: false,\n        form: {\n          fileCategory: '',\n          title: '',\n          description: '',\n          name: '',\n          size: '',\n          url: ''\n        }\n      };\n      // 清空已上传文件\n      this.$refs.upload.clearFiles();\n    },\n    // 获取文件类别\n    getFileCategory: function getFileCategory() {\n      var _this = this;\n      this.$axios.get('/api/dic/item', {\n        dicTypeCode: 'file-category'\n      }).then(function (res) {\n        var result = res.data;\n        _this.fileCategory = result.data;\n      });\n    },\n    // 获取文件分页\n    getFilePage: function getFilePage(param) {\n      var _this2 = this;\n      this.$axios.get('/api/file/page', param).then(function (res) {\n        var result = res.data;\n        _this2.filePage = result.data;\n      });\n    },\n    // 根据文件名获取文件图标样式\n    getFileIcon: function getFileIcon(filename) {\n      var suffix = filename.substr(filename.lastIndexOf('.') + 1);\n      switch (suffix) {\n        case 'ppt':\n        case 'pptx':\n          return 'file powerpoint outline yellow';\n        case 'doc':\n        case 'docx':\n          return 'file word outline blue';\n        case 'xls':\n        case 'xlsx':\n          return 'file excel outline green';\n        case 'pdf':\n          return 'file pdf outline orange';\n        default:\n          return 'file alternate outline';\n      }\n    },\n    // 文件上传前的回调\n    handleBeforeUpload: function handleBeforeUpload() {\n      // 限制上传文件数量\n      if (this.$refs.upload.fileList.length > 0) {\n        this.$Notice.warning({\n          title: 'Warning',\n          desc: '一次只能上传一份资料，若要更换，请删除已上传文件'\n        });\n        return false;\n      }\n      return true;\n    },\n    // 文件上传成功时的回调\n    handleSuccess: function handleSuccess(res, file, fileList) {\n      var uploadInfo = res.data;\n      this.fileAddModal.form.name = uploadInfo.name;\n      this.fileAddModal.form.size = uploadInfo.size;\n      this.fileAddModal.form.url = uploadInfo.url;\n    },\n    // 文件上传失败时的回调\n    handleError: function handleError(err, res, file) {\n      this.$Notice.error({\n        title: 'Oops',\n        desc: file.name + ' 上传失败'\n      });\n    },\n    // 文件添加\n    addFile: function addFile() {\n      var _this3 = this;\n      this.$axios.post('/api/file', this.fileAddModal.form).then(function (res) {\n        var result = res.data;\n        if (result.success) {\n          _this3.$Notice.success({\n            title: 'Bingo',\n            desc: '分享成功'\n          });\n          _this3.resetFileAddModal();\n          _this3.getFilePage(_this3.param);\n        }\n      });\n    },\n    // 文件下载\n    downloadFile: function downloadFile(file) {\n      this.$axios.put(\"/api/file/\".concat(file.id, \"/download-count\")).then(function (res) {\n        return file.downloadCount++;\n      });\n    },\n    // 点赞\n    addZan: function addZan(resource) {\n      this.$axios.post('/api/zan', {\n        resourceId: resource.id\n      }).then(function (res) {\n        return resource.zanCount++;\n      });\n    },\n    // 获取评论\n    getCommentList: function getCommentList(resource) {\n      var _this4 = this;\n      this.currentResource = resource;\n      this.$axios.get(\"/api/comment/\".concat(resource.id)).then(function (res) {\n        var result = res.data;\n        _this4.commentList = result.data;\n        // 展示评论\n        _this4.commentAddModal.show = true;\n      });\n    },\n    // 初始化评论\n    initComment: function initComment() {\n      this.commentAddModal.form = {\n        resourceId: null,\n        parentId: null,\n        replyUserId: null,\n        value: '',\n        content: ''\n      };\n    },\n    // 添加评论\n    addComment: function addComment() {\n      var _this5 = this;\n      // 设置资源 ID\n      this.commentAddModal.form.resourceId = this.currentResource.id;\n      // 判断是评论还是回复\n      if (this.commentAddModal.form.value.startsWith('@') && this.commentAddModal.form.replyUserId !== null) {\n        // 回复时去掉评论内容中的回复用户名\n        var index = this.commentAddModal.form.value.indexOf(' ');\n        this.commentAddModal.form.content = this.commentAddModal.form.value.substr(index + 1);\n      } else {\n        this.commentAddModal.form.parentId = null;\n        this.commentAddModal.form.replyUserId = null;\n        this.commentAddModal.form.content = this.commentAddModal.form.value;\n      }\n      this.$axios.post('/api/comment', this.commentAddModal.form).then(function (res) {\n        _this5.initComment();\n        _this5.currentResource.commentCount++;\n        _this5.getCommentList(_this5.currentResource);\n      });\n    },\n    // 回复评论\n    replyComment: function replyComment(parentId, replyUser) {\n      this.commentAddModal.form.parentId = parentId;\n      this.commentAddModal.form.replyUserId = replyUser.id;\n      this.commentAddModal.form.value = \"@\".concat(replyUser.nickname, \" \");\n      this.$refs.commentInput.focus();\n    },\n    // 上一页\n    previousPage: function previousPage() {\n      this.param.current--;\n      this.getFilePage(this.param);\n      this.$refs.container.scrollIntoView();\n    },\n    // 下一页\n    nextPage: function nextPage() {\n      this.param.current++;\n      this.getFilePage(this.param);\n      this.$refs.container.scrollIntoView();\n    }\n  },\n  mounted: function mounted() {\n    this.getFileCategory();\n    this.getFilePage(this.param);\n  }\n};",{"version":3,"names":["name","data","menu","active","items","localStorage","activeFileCategory","fileCategory","code","param","general","desc","current","filePage","fileAddModal","show","form","title","description","size","url","commentList","id","content","createTime","postUser","username","nickname","avatar","children","replyUser","commentAddModal","parentId","resourceId","replyUserId","value","currentResource","methods","select","item","getFilePage","selectCategory","resetFileAddModal","$refs","upload","clearFiles","getFileCategory","_this","$axios","get","dicTypeCode","then","res","result","_this2","getFileIcon","filename","suffix","substr","lastIndexOf","handleBeforeUpload","fileList","length","$Notice","warning","handleSuccess","file","uploadInfo","handleError","err","error","addFile","_this3","post","success","downloadFile","put","concat","downloadCount","addZan","resource","zanCount","getCommentList","_this4","initComment","addComment","_this5","startsWith","index","indexOf","commentCount","replyComment","commentInput","focus","previousPage","container","scrollIntoView","nextPage","mounted"],"sources":["src/views/file/File.vue"],"sourcesContent":["<template>\n  <div class=\"container\" ref=\"container\">\n    <Row>\n      <iCol span=\"17\">\n        <!-- 文件操作菜单 -->\n        <sui-menu>\n          <a is=\"sui-menu-item\" v-for=\"item in menu.items\" :key=\"item\" :content=\"item\"\n             :active=\"item === menu.active\" @click=\"select(item)\"/>\n          <sui-menu-item position=\"right\">\n            <sui-input transparent icon=\"search\" placeholder=\"搜索\"\n                       v-model=\"param.general\" @keydown.enter=\"getFilePage(param)\"/>\n          </sui-menu-item>\n        </sui-menu>\n        <!-- 文件操作菜单 END -->\n        <!-- 文件类别 -->\n        <div class=\"file-category\">\n          <Tag type=\"dot\" v-if=\"activeFileCategory === '所有'\" color=\"#32C2BC\" @click.native=\"selectCategory('所有')\">所有\n          </Tag>\n          <Tag type=\"dot\" v-else @click.native=\"selectCategory('所有')\">所有</Tag>\n          <template v-for=\"item in fileCategory\">\n            <Tag type=\"dot\" v-if=\"item.name === activeFileCategory\" color=\"#32C2BC\"\n                 @click.native=\"selectCategory(item.name)\">\n              {{item.name}}\n            </Tag>\n            <Tag type=\"dot\" v-else @click.native=\"selectCategory(item.name)\">{{item.name}}</Tag>\n          </template>\n        </div>\n        <!-- 文件类别 END -->\n        <!-- 文件列表 -->\n        <sui-card class=\"fluid file-card\">\n          <sui-message attached=\"top\">文件列表</sui-message>\n          <sui-card-content>\n            <!-- 文件项 -->\n            <sui-item-group>\n              <sui-item v-for=\"file in filePage.records\" :key=\"file.id\">\n                <sui-icon :name=\"getFileIcon(file.name)\"/>\n                <sui-item-content>\n                  <sui-item-header>\n                    <router-link :to=\"'/file/' + file.id\" style=\"color: #000;\">{{file.title}}</router-link>\n                    <sui-label basic color=\"teal\">{{file.fileCategory}}</sui-label>\n                  </sui-item-header>\n                  <sui-item-meta>\n                    <span class=\"file-user-nickname\">\n                      <router-link :to=\"'/user/' + file.user.id\" style=\"color: #555\">{{file.user.nickname}}</router-link>\n                    </span>\n                    <span class=\"file-create-time\"><Time :time=\"file.createTime\"/></span>\n                    <a :href=\"file.url\" :download=\"file.name\" @click=\"downloadFile(file)\">⏬ {{file.name}}</a>\n                  </sui-item-meta>\n                  <sui-item-description>\n                    <p>{{file.description}}</p>\n                  </sui-item-description>\n                  <sui-item-extra>\n                    <span class=\"file-size\">大小：{{file.size}}</span>\n                    <span class=\"file-download-count\">下载：{{file.downloadCount}}</span>\n                    <span class=\"file-resource-zan-count\" @click=\"addZan(file.resource)\">\n                      👍 {{file.resource.zanCount}}\n                    </span>\n                    <span class=\"file-resource-comment-count\" @click=\"getCommentList(file.resource)\">\n                      💬 {{file.resource.commentCount}}\n                    </span>\n                  </sui-item-extra>\n                </sui-item-content>\n              </sui-item>\n            </sui-item-group>\n            <!-- 文件项 END -->\n          </sui-card-content>\n          <sui-button-group attached=\"bottom\" basic>\n            <sui-button content=\"上一页\" icon=\"left chevron\" label-position=\"left\" @click=\"previousPage\"\n                        :disabled=\"this.param.current <= 1\"/>\n            <sui-button-or/>\n            <sui-button content=\"下一页\" icon=\"right chevron\" label-position=\"right\" @click=\"nextPage\"\n                        :disabled=\"this.param.current >= this.filePage.pages\"/>\n          </sui-button-group>\n        </sui-card>\n        <!-- 文件列表 END -->\n      </iCol>\n      <iCol span=\"7\">\n        <!-- 消息提示 -->\n        <sui-message>\n          <sui-message-header>\n            <i class=\"handshake outline icon\"/> 分享学习资料，让更多人获益。\n          </sui-message-header>\n          <p style=\"text-align:justify\">\n            一个人独行可以走得很快，一群人才会走得更远！我们鼓励学习交流，更鼓励资源分享。\n            如果手里有比较好的学习资料，希望你能分享出来，让大家从中受益。\n            与此同时，你也将会在这个平台上找到你所需要的学习资料。“分享”帮助你我探索更广阔的世界 🧐\n          </p>\n          <sui-button fluid basic color=\"teal\" icon=\"upload\" content=\"上传文件\" @click=\"fileAddModal.show = true\"/>\n        </sui-message>\n        <!-- 消息提示 END -->\n      </iCol>\n    </Row>\n    <!-- 文件上传模态框 -->\n    <Modal v-model=\"fileAddModal.show\" title=\"上传文件\" width=\"600\" scrollable>\n      <Form :model=\"fileAddModal.form\" :label-width=\"50\">\n        <FormItem label=\"类别\" required>\n          <Select v-model=\"fileAddModal.form.fileCategory\" size=\"large\">\n            <Option v-for=\"item in fileCategory\" :key=\"item.name\" :value=\"item.name\" :label=\"item.name\"/>\n          </Select>\n        </FormItem>\n        <FormItem label=\"标题\" required>\n          <Input v-model=\"fileAddModal.form.title\" size=\"large\" placeholder=\"醒目的标题能吸引更多人下载\"/>\n        </FormItem>\n        <FormItem label=\"描述\" required>\n          <Input v-model=\"fileAddModal.form.description\" type=\"textarea\" size=\"large\"\n                 :autosize=\"{minRows: 5,maxRows: 10}\" placeholder=\"简短的描述有助于他人了解资料的用途\"/>\n        </FormItem>\n        <FormItem label=\"文件\" required style=\"margin-bottom: 0\">\n          <Upload\n            ref=\"upload\"\n            type=\"drag\"\n            :action=\"localStorage\"\n            :data=\"{type: 'file'}\"\n            :before-upload=\"handleBeforeUpload\"\n            :on-success=\"handleSuccess\"\n            :on-error=\"handleError\">\n            <div style=\"padding: 20px 0\">\n              <Icon type=\"ios-cloud-upload\" size=\"52\" style=\"color: #32C2BC\"/>\n              <p>点击或拖拽文件进行上传</p>\n            </div>\n          </Upload>\n        </FormItem>\n      </Form>\n      <template #footer>\n        <Button type=\"text\" @click=\"resetFileAddModal\">取消</Button>\n        <Button @click=\"addFile\">确定分享</Button>\n      </template>\n    </Modal>\n    <!-- 文件上传模态框 END -->\n    <!-- 评论模态框 -->\n    <Modal v-model=\"commentAddModal.show\" title=\"发表评论\" width=\"600\" footer-hide>\n      <Input ref=\"commentInput\" v-model=\"commentAddModal.form.value\" type=\"textarea\" :rows=\"3\" placeholder=\"添加评论\"\n             @on-enter=\"addComment\"/>\n      <sui-comment-group class=\"comment-group\">\n        <sui-comment v-for=\"comment in commentList\" :key=\"comment.id\">\n          <sui-comment-avatar :src=\"comment.postUser.avatar\"/>\n          <sui-comment-content>\n            <a is=\"sui-comment-author\">{{comment.postUser.nickname}}</a>\n            <sui-comment-metadata>\n              <Time :time=\"comment.createTime\"/>\n            </sui-comment-metadata>\n            <sui-comment-text>{{comment.content}}</sui-comment-text>\n            <sui-comment-actions>\n              <sui-comment-action @click=\"replyComment(comment.id, comment.postUser)\">回复</sui-comment-action>\n            </sui-comment-actions>\n          </sui-comment-content>\n          <!-- 子评论 -->\n          <sui-comment-group v-if=\"comment.children.length > 0\">\n            <sui-comment v-for=\"child in comment.children\" :key=\"child.id\">\n              <sui-comment-avatar :src=\"child.postUser.avatar\"/>\n              <sui-comment-content>\n                <a is=\"sui-comment-author\">{{child.postUser.nickname}}</a>\n                <sui-comment-metadata>\n                  <Time :time=\"child.createTime\"/>\n                </sui-comment-metadata>\n                <sui-comment-text>\n                  <a :href=\"child.replyUser.id\">@{{child.replyUser.nickname}}</a>\n                  {{child.content}}\n                </sui-comment-text>\n                <sui-comment-actions>\n                  <sui-comment-action @click=\"replyComment(comment.id, child.postUser)\">回复</sui-comment-action>\n                </sui-comment-actions>\n              </sui-comment-content>\n            </sui-comment>\n          </sui-comment-group>\n          <!-- 子评论 END -->\n        </sui-comment>\n      </sui-comment-group>\n    </Modal>\n    <!-- 评论模态框 END -->\n  </div>\n</template>\n\n<script>\n\nexport default {\n  name: 'File',\n  data() {\n    return {\n      menu: {\n        active: '最新',\n        items: ['最新', '最热']\n      },\n      localStorage: '/api/local-storage/upload',\n      activeFileCategory: '所有',\n      fileCategory: [{\n        name: '测试',\n        code: 'test'\n      }],\n      param: {\n        // 查询参数\n        fileCategory: null,\n        general: null,\n        // page & order 参数\n        desc: 'create_time',\n        current: 1\n      },\n      filePage: {\n        'records': [\n          {\n            'id': 1,\n            'userId': 1,\n            'resourceId': 2,\n            'fileCategory': '计算机类',\n            'title': '计算机类全套PPT，你值得拥有',\n            'description': '计算机类全套PPT，你值得拥有',\n            'name': '中北大学计算机类.ppt',\n            'size': '200MB',\n            'url': 'http://bkt.angus-liu.cn/中北大学计算机类.ppt',\n            'downloadCount': 0,\n            'createTime': '2019-05-13 09:18:13',\n            'user': {\n              'id': 1,\n              'username': 'admin',\n              'nickname': '管理员',\n              'avatar': 'http://img.angus-liu.cn/avatar/avatar07.png',\n              'sign': '一句话介绍自己'\n            },\n            'resource': {\n              'id': 2,\n              'zanCount': 0,\n              'pvCount': 0,\n              'commentCount': 0\n            }\n          }],\n        'total': 10,\n        'size': 10,\n        'current': 1,\n        'searchCount': true,\n        'pages': 1\n      },\n      fileAddModal: {\n        show: false,\n        form: {\n          fileCategory: '',\n          title: '',\n          description: '',\n          name: '',\n          size: '',\n          url: ''\n        }\n      },\n      commentList: [{\n        id: -1,\n        content: '测试评论',\n        createTime: '2019-05-21 20:15:39',\n        postUser: {\n          id: -1,\n          username: 'admin',\n          nickname: '管理员',\n          avatar: 'http://img.angus-liu.cn/avatar/avatar07.png'\n        },\n        children: [\n          {\n            id: -2,\n            content: '测试回复',\n            createTime: '2019-05-21 20:15:46',\n            postUser: {\n              id: 1,\n              username: 'admin',\n              nickname: '管理员',\n              avatar: 'http://img.angus-liu.cn/avatar/avatar07.png'\n            },\n            replyUser: {\n              id: 1,\n              username: 'admin',\n              nickname: '管理员',\n              avatar: 'http://img.angus-liu.cn/avatar/avatar07.png'\n            }\n          }\n        ]\n      }],\n      commentAddModal: {\n        show: false,\n        form: {\n          parentId: null,\n          resourceId: null,\n          replyUserId: null,\n          value: '',\n          content: ''\n        }\n      },\n      currentResource: {}\n    }\n  },\n  methods: {\n    // 菜单切换\n    select(item) {\n      this.menu.active = item;\n      if (item === '最新') {\n        this.param.desc = 'create_time';\n      } else {\n        this.param.desc = 'download_count, comment_count, zan_count';\n      }\n      this.param.current = 1;\n      this.getFilePage(this.param);\n    },\n    // 类别切换\n    selectCategory(fileCategory) {\n      this.activeFileCategory = fileCategory;\n      if (fileCategory === '所有') {\n        this.param.fileCategory = null;\n      } else {\n        this.param.fileCategory = fileCategory;\n      }\n      this.param.current = 1;\n      this.getFilePage(this.param);\n    },\n    // 初始化文件添加模态框\n    resetFileAddModal() {\n      this.fileAddModal = {\n        show: false,\n        form: {\n          fileCategory: '',\n          title: '',\n          description: '',\n          name: '',\n          size: '',\n          url: ''\n        }\n      };\n      // 清空已上传文件\n      this.$refs.upload.clearFiles();\n    },\n    // 获取文件类别\n    getFileCategory() {\n      this.$axios.get('/api/dic/item', { dicTypeCode: 'file-category' })\n        .then(res => {\n          let result = res.data;\n          this.fileCategory = result.data;\n        });\n    },\n    // 获取文件分页\n    getFilePage(param) {\n      this.$axios.get('/api/file/page', param)\n        .then(res => {\n          let result = res.data;\n          this.filePage = result.data;\n        })\n    },\n    // 根据文件名获取文件图标样式\n    getFileIcon(filename) {\n      let suffix = filename.substr(filename.lastIndexOf('.') + 1);\n      switch (suffix) {\n        case 'ppt':\n        case 'pptx':\n          return 'file powerpoint outline yellow';\n        case 'doc':\n        case 'docx':\n          return 'file word outline blue';\n        case 'xls':\n        case 'xlsx':\n          return 'file excel outline green';\n        case 'pdf':\n          return 'file pdf outline orange';\n        default:\n          return 'file alternate outline';\n      }\n    },\n    // 文件上传前的回调\n    handleBeforeUpload() {\n      // 限制上传文件数量\n      if (this.$refs.upload.fileList.length > 0) {\n        this.$Notice.warning({ title: 'Warning', desc: '一次只能上传一份资料，若要更换，请删除已上传文件' });\n        return false;\n      }\n      return true;\n    },\n    // 文件上传成功时的回调\n    handleSuccess(res, file, fileList) {\n      let uploadInfo = res.data;\n      this.fileAddModal.form.name = uploadInfo.name;\n      this.fileAddModal.form.size = uploadInfo.size;\n      this.fileAddModal.form.url = uploadInfo.url;\n    },\n    // 文件上传失败时的回调\n    handleError(err, res, file) {\n      this.$Notice.error({ title: 'Oops', desc: file.name + ' 上传失败' });\n    },\n    // 文件添加\n    addFile() {\n      this.$axios.post('/api/file', this.fileAddModal.form)\n        .then(res => {\n          let result = res.data;\n          if (result.success) {\n            this.$Notice.success({ title: 'Bingo', desc: '分享成功' });\n            this.resetFileAddModal();\n            this.getFilePage(this.param);\n          }\n        })\n    },\n    // 文件下载\n    downloadFile(file) {\n      this.$axios.put(`/api/file/${file.id}/download-count`)\n        .then(res => file.downloadCount++);\n    },\n    // 点赞\n    addZan(resource) {\n      this.$axios.post('/api/zan', { resourceId: resource.id })\n        .then(res => resource.zanCount++);\n    },\n    // 获取评论\n    getCommentList(resource) {\n      this.currentResource = resource;\n      this.$axios.get(`/api/comment/${resource.id}`)\n        .then(res => {\n          let result = res.data;\n          this.commentList = result.data;\n          // 展示评论\n          this.commentAddModal.show = true;\n        });\n    },\n    // 初始化评论\n    initComment() {\n      this.commentAddModal.form = {\n        resourceId: null,\n        parentId: null,\n        replyUserId: null,\n        value: '',\n        content: ''\n      }\n    },\n    // 添加评论\n    addComment() {\n      // 设置资源 ID\n      this.commentAddModal.form.resourceId = this.currentResource.id;\n      // 判断是评论还是回复\n      if (this.commentAddModal.form.value.startsWith('@')\n        && this.commentAddModal.form.replyUserId !== null) {\n        // 回复时去掉评论内容中的回复用户名\n        let index = this.commentAddModal.form.value.indexOf(' ');\n        this.commentAddModal.form.content = this.commentAddModal.form.value.substr(index + 1);\n      } else {\n        this.commentAddModal.form.parentId = null;\n        this.commentAddModal.form.replyUserId = null;\n        this.commentAddModal.form.content = this.commentAddModal.form.value;\n      }\n      this.$axios.post('/api/comment', this.commentAddModal.form)\n        .then(res => {\n          this.initComment();\n          this.currentResource.commentCount++;\n          this.getCommentList(this.currentResource);\n        });\n    },\n    // 回复评论\n    replyComment(parentId, replyUser) {\n      this.commentAddModal.form.parentId = parentId;\n      this.commentAddModal.form.replyUserId = replyUser.id;\n      this.commentAddModal.form.value = `@${replyUser.nickname} `;\n      this.$refs.commentInput.focus();\n    },\n    // 上一页\n    previousPage() {\n      this.param.current--;\n      this.getFilePage(this.param);\n      this.$refs.container.scrollIntoView();\n    },\n    // 下一页\n    nextPage() {\n      this.param.current++;\n      this.getFilePage(this.param);\n      this.$refs.container.scrollIntoView();\n    }\n  },\n  mounted() {\n    this.getFileCategory();\n    this.getFilePage(this.param);\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.container {\n  width: 1200px;\n  margin: 10px auto;\n\n  .ivu-col {\n    padding: 7px;\n  }\n\n  .file-category {\n    .ivu-tag {\n      border: 1px solid rgba(34, 36, 38, .15);\n      box-shadow: 0 1px 2px 0 rgba(34, 36, 38, .15);\n    }\n  }\n\n  .card {\n    .items {\n      padding: 0 10px;\n\n      .item {\n        margin: 20px 0;\n        padding-bottom: 10px;\n        border-bottom: 1px dashed #ddd;\n\n        .header {\n          line-height: 30px;\n        }\n\n        i {\n          font-size: 5em;\n          line-height: 1;\n          vertical-align: middle;\n        }\n      }\n\n      .item:last-child {\n        padding-bottom: 0;\n        border-bottom: none;\n      }\n    }\n  }\n\n  ul {\n    list-style: none;\n\n    li {\n      display: inline-block;\n      margin-right: 15px;\n      color: #546a7e;\n    }\n  }\n\n  .file-card {\n    .file-user-nickname,\n    .file-create-time,\n    .file-size,\n    .file-download-count,\n    .file-resource-zan-count,\n    .file-resource-comment-count {\n      display: inline-block;\n      width: 150px;\n    }\n\n    .file-resource-zan-count,\n    .file-resource-comment-count {\n      width: 60px;\n      cursor: pointer;\n    }\n\n    .file-resource-zan-count:hover,\n    .file-resource-comment-count:hover {\n      color: #000;\n    }\n  }\n}\n\n.comment-group {\n  max-height: 600px;\n  overflow: auto;\n}\n</style>\n"],"mappings":";;AA+KA;EACAA,IAAA;EACAC,IAAA,WAAAA,KAAA;IACA;MACAC,IAAA;QACAC,MAAA;QACAC,KAAA;MACA;MACAC,YAAA;MACAC,kBAAA;MACAC,YAAA;QACAP,IAAA;QACAQ,IAAA;MACA;MACAC,KAAA;QACA;QACAF,YAAA;QACAG,OAAA;QACA;QACAC,IAAA;QACAC,OAAA;MACA;MACAC,QAAA;QACA,YACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;YACA;YACA;YACA;YACA;YACA;UACA;UACA;YACA;YACA;YACA;YACA;UACA;QACA;QACA;QACA;QACA;QACA;QACA;MACA;MACAC,YAAA;QACAC,IAAA;QACAC,IAAA;UACAT,YAAA;UACAU,KAAA;UACAC,WAAA;UACAlB,IAAA;UACAmB,IAAA;UACAC,GAAA;QACA;MACA;MACAC,WAAA;QACAC,EAAA;QACAC,OAAA;QACAC,UAAA;QACAC,QAAA;UACAH,EAAA;UACAI,QAAA;UACAC,QAAA;UACAC,MAAA;QACA;QACAC,QAAA,GACA;UACAP,EAAA;UACAC,OAAA;UACAC,UAAA;UACAC,QAAA;YACAH,EAAA;YACAI,QAAA;YACAC,QAAA;YACAC,MAAA;UACA;UACAE,SAAA;YACAR,EAAA;YACAI,QAAA;YACAC,QAAA;YACAC,MAAA;UACA;QACA;MAEA;MACAG,eAAA;QACAhB,IAAA;QACAC,IAAA;UACAgB,QAAA;UACAC,UAAA;UACAC,WAAA;UACAC,KAAA;UACAZ,OAAA;QACA;MACA;MACAa,eAAA;IACA;EACA;EACAC,OAAA;IACA;IACAC,MAAA,WAAAA,OAAAC,IAAA;MACA,KAAArC,IAAA,CAAAC,MAAA,GAAAoC,IAAA;MACA,IAAAA,IAAA;QACA,KAAA9B,KAAA,CAAAE,IAAA;MACA;QACA,KAAAF,KAAA,CAAAE,IAAA;MACA;MACA,KAAAF,KAAA,CAAAG,OAAA;MACA,KAAA4B,WAAA,MAAA/B,KAAA;IACA;IACA;IACAgC,cAAA,WAAAA,eAAAlC,YAAA;MACA,KAAAD,kBAAA,GAAAC,YAAA;MACA,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","ignoreList":[]}]}